openapi: 3.0.0
paths:
  /experimental/rootcheck:
    delete:
      tags:
      - Experimental
      summary: Clear rootcheck results
      description: Clear rootcheck database for all agents or a list of them
      operationId: api.controllers.experimental_controller.clear_rootcheck_database
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/rootcheck:clear'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list_all'
      responses:
        '200':
          description: Clear rootcheck database for all agents or a list of them
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponse'
              example:
                data:
                  affected_items:
                  - '002'
                  - '003'
                  total_affected_items: 2
                  failed_items: []
                  total_failed_items: 0
                message: Rootcheck database was cleared on returned agents
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscheck:
    delete:
      tags:
      - Experimental
      summary: Clear agents FIM results
      description: Clear the syscheck database for all agents or a list of them
      operationId: api.controllers.experimental_controller.clear_syscheck_database
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscheck:clear'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list_all'
      responses:
        '200':
          description: Delete syscheck database
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseAgentIDs'
              example:
                data:
                  affected_items:
                  - '000'
                  - '001'
                  - '002'
                  - '003'
                  - '004'
                  - '005'
                  - '006'
                  - '007'
                  - 008
                  - 009
                  - '010'
                  - '011'
                  - '012'
                  total_affected_items: 13
                  total_failed_items: 0
                  failed_items: []
                message: Syscheck database was cleared on returned agents
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/ciscat/results:
    get:
      tags:
      - Experimental
      summary: Get agents CIS-CAT results
      description: Return CIS-CAT results for all agents or a list of them
      operationId: api.controllers.experimental_controller.get_cis_cat_results
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/ciscat:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/benchmark'
      - $ref: '#/components/parameters/profile'
      - $ref: '#/components/parameters/pass'
      - $ref: '#/components/parameters/fail'
      - $ref: '#/components/parameters/error'
      - $ref: '#/components/parameters/notchecked'
      - $ref: '#/components/parameters/unknown'
      - $ref: '#/components/parameters/score'
      responses:
        '200':
          description: Return a list of CIS-CAT results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseCiscatResult'
              example:
                data:
                  affected_items:
                  - agent_id: '001'
                    benchmark: CIS Ubuntu Linux 16.04 LTS Benchmark
                    error: 0
                    fail: 82
                    notchecked: 36
                    pass: 102
                    profile: xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Server
                    scan:
                      id: 1422619291
                      time: '2019-12-03T08:38:35.230Z'
                    score: 55
                    unknown: 0
                  - agent_id: '002'
                    benchmark: CIS Ubuntu Linux 16.04 LTS Benchmark
                    error: 0
                    fail: 82
                    notchecked: 36
                    pass: 102
                    profile: xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Server
                    scan:
                      id: 1794774880
                      time: '2019-12-03T08:38:27.743Z'
                    score: 55
                    unknown: 0
                  - agent_id: '003'
                    benchmark: CIS Ubuntu Linux 16.04 LTS Benchmark
                    error: 0
                    fail: 82
                    notchecked: 36
                    pass: 102
                    profile: xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Server
                    scan:
                      id: 622382213
                      time: '2019-12-03T08:39:02.569Z'
                    score: 55
                    unknown: 0
                  failed_items: []
                  total_affected_items: 3
                  total_failed_items: 0
                message: All CISCAT results were returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscollector/hardware:
    get:
      tags:
      - Experimental
      summary: Get agents hardware
      description: Return all agents (or a list of them) hardware info. This information
        include cpu, ram, scan info among others of all agents
      operationId: api.controllers.experimental_controller.get_hardware_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscollector:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/ram.free'
      - $ref: '#/components/parameters/ram.total'
      - $ref: '#/components/parameters/cpu.cores'
      - $ref: '#/components/parameters/cpu.mhz'
      - $ref: '#/components/parameters/cpu.name'
      - $ref: '#/components/parameters/board_serial'
      responses:
        '200':
          description: Return a list of agent's hardware results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseSyscollectorHardware'
              example:
                data:
                  affected_items:
                  - agent_id: '000'
                    board_serial: BSS-0123456789
                    cpu:
                      cores: 12
                      mhz: 3094.875
                      name: Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz
                    ram:
                      free: 6958480
                      total: 16263580
                      usage: 58
                    scan:
                      id: 1452382474
                      time: '2019-12-03T08:37:42Z'
                  - agent_id: '001'
                    board_serial: BSS-0123456789
                    cpu:
                      cores: 12
                      mhz: 2688.144
                      name: Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz
                    ram:
                      free: 5793604
                      total: 16263580
                      usage: 65
                    scan:
                      id: 1317471702
                      time: '2019-12-03T08:38:29Z'
                  - agent_id: '002'
                    board_serial: BSS-0123456789
                    cpu:
                      cores: 12
                      mhz: 2896.127
                      name: Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz
                    ram:
                      free: 5844192
                      total: 16263580
                      usage: 65
                    scan:
                      id: 2069790203
                      time: '2019-12-03T08:38:21Z'
                  failed_items: []
                  total_affected_items: 3
                  total_failed_items: 0
                message: All specified syscollector information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscollector/netaddr:
    get:
      tags:
      - Experimental
      summary: Get agents netaddr
      description: Return all agents (or a list of them) IPv4 and IPv6 addresses associated
        to their network interfaces. This information include used IP protocol, interface,
        and IP address among others
      operationId: api.controllers.experimental_controller.get_network_address_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscollector:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/proto'
      - $ref: '#/components/parameters/address'
      - $ref: '#/components/parameters/broadcast'
      - $ref: '#/components/parameters/netmask'
      responses:
        '200':
          description: Return a list of agent's network results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseSyscollectorNetwork'
              example:
                data:
                  affected_items:
                  - address: 172.23.0.3
                    agent_id: '000'
                    broadcast: 172.23.255.255
                    iface: eth0
                    netmask: 255.255.0.0
                    proto: ipv4
                    scan:
                      id: 1921972007
                  - address: 172.23.0.6
                    agent_id: '001'
                    broadcast: 172.23.255.255
                    iface: eth0
                    netmask: 255.255.0.0
                    proto: ipv4
                    scan:
                      id: 1704225423
                  - address: 172.23.0.7
                    agent_id: '002'
                    broadcast: 172.23.255.255
                    iface: eth0
                    netmask: 255.255.0.0
                    proto: ipv4
                    scan:
                      id: 1393900138
                  failed_items: []
                  total_affected_items: 3
                  total_failed_items: 0
                message: All specified syscollector information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscollector/netiface:
    get:
      tags:
      - Experimental
      summary: Get agents netiface
      description: Return all agents (or a list of them) network interfaces. This
        information includes rx, scan, tx info and some network information among
        other
      operationId: api.controllers.experimental_controller.get_network_interface_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscollector:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/name'
      - $ref: '#/components/parameters/adapter'
      - $ref: '#/components/parameters/type_syscollector'
      - $ref: '#/components/parameters/state'
      - $ref: '#/components/parameters/mtu'
      - $ref: '#/components/parameters/tx.packets'
      - $ref: '#/components/parameters/rx.packets'
      - $ref: '#/components/parameters/tx.bytes'
      - $ref: '#/components/parameters/rx.bytes'
      - $ref: '#/components/parameters/tx.errors'
      - $ref: '#/components/parameters/rx.errors'
      - $ref: '#/components/parameters/tx.dropped'
      - $ref: '#/components/parameters/rx.dropped'
      responses:
        '200':
          description: Return a list of agent's network interfaces results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseSyscollectorInterface'
              example:
                data:
                  affected_items:
                  - agent_id: '000'
                    mac: 02:42:ac:17:00:03
                    mtu: 1500
                    name: eth0
                    rx:
                      bytes: 7161
                      dropped: 0
                      errors: 0
                      packets: 58
                    scan:
                      id: 1921972007
                      time: '2019-12-03T09:57:04Z'
                    state: up
                    tx:
                      bytes: 115
                      dropped: 0
                      errors: 0
                      packets: 2
                    type: ethernet
                  - agent_id: '001'
                    mac: 02:42:ac:17:00:06
                    mtu: 1500
                    name: eth0
                    rx:
                      bytes: 868555
                      dropped: 0
                      errors: 0
                      packets: 1037
                    scan:
                      id: 1704225423
                      time: '2019-12-03T09:57:42Z'
                    state: up
                    tx:
                      bytes: 231924
                      dropped: 0
                      errors: 0
                      packets: 910
                    type: ethernet
                  - agent_id: '002'
                    mac: 02:42:ac:17:00:07
                    mtu: 1500
                    name: eth0
                    rx:
                      bytes: 876071
                      dropped: 0
                      errors: 0
                      packets: 1152
                    scan:
                      id: 1393900138
                      time: '2019-12-03T09:57:43Z'
                    state: up
                    tx:
                      bytes: 232396
                      dropped: 0
                      errors: 0
                      packets: 906
                    type: ethernet
                  failed_items: []
                  total_affected_items: 3
                  total_failed_items: 0
                message: All specified syscollector information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscollector/netproto:
    get:
      tags:
      - Experimental
      summary: Get agents netproto
      description: Return all agents (or a list of them) routing configuration for
        each network interface. This information includes interface, type protocol
        information among other
      operationId: api.controllers.experimental_controller.get_network_protocol_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscollector:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/iface'
      - $ref: '#/components/parameters/type_syscollector'
      - $ref: '#/components/parameters/gateway'
      - $ref: '#/components/parameters/dhcp'
      responses:
        '200':
          description: Return a list of agent's network protocol results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseSyscollectorProtocol'
              example:
                data:
                  affected_items:
                  - scan:
                      id: 1248412797
                    iface: eth0
                    type: ipv4
                    gateway: 172.24.0.1
                    dhcp: enabled
                    agent_id: '000'
                  - scan:
                      id: 1213296763
                    iface: eth0
                    type: ipv4
                    gateway: 172.24.0.1
                    dhcp: enabled
                    agent_id: '001'
                  - scan:
                      id: 341262067
                    type: ipv4
                    iface: eth0
                    dhcp: enabled
                    gateway: 172.24.0.1
                    agent_id: '002'
                  total_affected_items: 3
                  total_failed_items: 0
                  failed_items: []
                message: All specified syscollector information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscollector/os:
    get:
      tags:
      - Experimental
      summary: Get agents OS
      description: Return all agents (or a list of them) OS info. This information
        includes os information, architecture information among other
      operationId: api.controllers.experimental_controller.get_os_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscollector:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/os.name'
      - $ref: '#/components/parameters/architecture'
      - $ref: '#/components/parameters/os.version'
      - $ref: '#/components/parameters/version'
      - $ref: '#/components/parameters/release'
      responses:
        '200':
          description: Return a list of agent's OS results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseSyscollectorOS'
              example:
                data:
                  affected_items:
                  - os:
                      codename: Bionic Beaver
                      major: '18'
                      minor: '04'
                      name: Ubuntu
                      platform: ubuntu
                      version: 18.04.4 LTS (Bionic Beaver)
                    scan:
                      id: 496386874
                      time: '2020-04-15T11:02:03Z'
                    sysname: Linux
                    hostname: wazuh-master
                    version: '#34~1584408018~19.10~21df4b1-Ubuntu SMP Tue Mar 17 13:38:51
                      UTC '
                    release: 5.3.0-7642-generic
                    architecture: x86_64
                    agent_id: '000'
                  - os:
                      codename: Xenial Xerus
                      major: '16'
                      minor: '04'
                      name: Ubuntu
                      platform: ubuntu
                      version: 16.04.6 LTS (Xenial Xerus)
                    scan:
                      id: 196194860
                      time: '2020-04-15T11:02:23Z'
                    sysname: Linux
                    hostname: wazuh-agent1
                    version: '#34~1584408018~19.10~21df4b1-Ubuntu SMP Tue Mar 17 13:38:51
                      UTC '
                    release: 5.3.0-7642-generic
                    architecture: x86_64
                    agent_id: '001'
                  - os:
                      codename: Xenial Xerus
                      major: '16'
                      minor: '04'
                      name: Ubuntu
                      platform: ubuntu
                      version: 16.04.6 LTS (Xenial Xerus)
                    scan:
                      id: 763390318
                      time: '2020-04-15T11:02:52Z'
                    hostname: wazuh-agent2
                    release: 5.3.0-7642-generic
                    version: '#34~1584408018~19.10~21df4b1-Ubuntu SMP Tue Mar 17 13:38:51
                      UTC '
                    architecture: x86_64
                    sysname: Linux
                    agent_id: '002'
                  total_affected_items: 3
                  total_failed_items: 0
                  failed_items: []
                message: All specified syscollector information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscollector/packages:
    get:
      tags:
      - Experimental
      summary: Get agents packages
      description: Return all agents (or a list of them) packages info. This information
        includes name, section, size, and priority information of all packages among
        other
      operationId: api.controllers.experimental_controller.get_packages_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscollector:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/vendor'
      - $ref: '#/components/parameters/name'
      - $ref: '#/components/parameters/architecture'
      - $ref: '#/components/parameters/file_format'
      - $ref: '#/components/parameters/package_version'
      responses:
        '200':
          description: Return a list of agent's packages results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseSyscollectorPackages'
              example:
                data:
                  affected_items:
                  - scan:
                      id: 1137251326
                      time: '2020-04-15T11:02:03Z'
                    name: libquadmath0
                    size: 269
                    version: 8.4.0-1ubuntu1~18.04
                    source: gcc-8
                    format: deb
                    section: libs
                    architecture: amd64
                    multiarch: same
                    description: GCC Quad-Precision Math Library
                    priority: optional
                    vendor: Ubuntu Core developers <ubuntu-devel-discuss@lists.ubuntu.com>
                    agent_id: '000'
                  - scan:
                      id: 1137251326
                      time: '2020-04-15T11:02:03Z'
                    name: libnpth0
                    size: 32
                    version: 1.5-3
                    source: npth
                    format: deb
                    section: libs
                    architecture: amd64
                    multiarch: same
                    description: replacement for GNU Pth using system threads
                    priority: optional
                    vendor: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
                    agent_id: '000'
                  - scan:
                      id: 1137251326
                      time: '2020-04-15T11:02:03Z'
                    name: fdisk
                    size: 427
                    version: 2.31.1-0.4ubuntu3.5
                    source: util-linux
                    format: deb
                    section: utils
                    architecture: amd64
                    multiarch: foreign
                    description: collection of partitioning utilities
                    priority: important
                    vendor: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
                    agent_id: '000'
                  total_affected_items: 3
                  total_failed_items: 0
                  failed_items: []
                message: All specified syscollector information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscollector/ports:
    get:
      tags:
      - Experimental
      summary: Get agents ports
      description: Return all agents (or a list of them) ports info. This information
        includes local IP, Remote IP, protocol information among other
      operationId: api.controllers.experimental_controller.get_ports_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscollector:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/pid'
      - $ref: '#/components/parameters/protocol'
      - $ref: '#/components/parameters/local.ip'
      - $ref: '#/components/parameters/local.port'
      - $ref: '#/components/parameters/remote.ip'
      - $ref: '#/components/parameters/tx_queue'
      - $ref: '#/components/parameters/state'
      - $ref: '#/components/parameters/process'
      responses:
        '200':
          description: Return a list of agent's packages results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseSyscollectorPorts'
              example:
                data:
                  affected_items:
                  - local:
                      ip: 127.0.0.11
                      port: 46841
                    remote:
                      ip: 0.0.0.0
                      port: 0
                    scan:
                      id: 315935312
                      time: '2020-04-15T11:02:07Z'
                    rx_queue: 0
                    state: listening
                    protocol: tcp
                    inode: 12387152
                    tx_queue: 0
                    agent_id: '000'
                  - local:
                      ip: 0.0.0.0
                      port: 1514
                    remote:
                      ip: 0.0.0.0
                      port: 0
                    scan:
                      id: 315935312
                      time: '2020-04-15T11:02:07Z'
                    rx_queue: 0
                    state: listening
                    protocol: tcp
                    inode: 12397927
                    tx_queue: 0
                    agent_id: '000'
                  - local:
                      ip: 0.0.0.0
                      port: 1515
                    remote:
                      ip: 0.0.0.0
                      port: 0
                    scan:
                      id: 315935312
                      time: '2020-04-15T11:02:07Z'
                    rx_queue: 0
                    state: listening
                    protocol: tcp
                    inode: 12397153
                    tx_queue: 0
                    agent_id: '000'
                  total_affected_items: 3
                  total_failed_items: 0
                  failed_items: []
                message: All specified syscollector information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscollector/processes:
    get:
      tags:
      - Experimental
      summary: Get agents processes
      description: Return all agents (or a list of them) processes info
      operationId: api.controllers.experimental_controller.get_processes_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscollector:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/process_pid'
      - $ref: '#/components/parameters/process_state'
      - $ref: '#/components/parameters/ppid'
      - $ref: '#/components/parameters/egroup'
      - $ref: '#/components/parameters/euser'
      - $ref: '#/components/parameters/fgroup'
      - $ref: '#/components/parameters/process_name'
      - $ref: '#/components/parameters/nlwp'
      - $ref: '#/components/parameters/pgrp'
      - $ref: '#/components/parameters/priority'
      - $ref: '#/components/parameters/rgroup'
      - $ref: '#/components/parameters/ruser'
      - $ref: '#/components/parameters/sgroup'
      - $ref: '#/components/parameters/suser'
      responses:
        '200':
          description: Return a list of agent's processes results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseSyscollectorProcesses'
              example:
                data:
                  affected_items:
                  - scan:
                      id: 28643647
                      time: '2020-04-15T11:02:07Z'
                    name: bash
                    suser: root
                    nlwp: 1
                    pgrp: 1
                    state: S
                    session: 1
                    utime: 23
                    egroup: root
                    ruser: root
                    argvs: /scripts/entrypoint.sh,wazuh-master,master-node,master
                    size: 4593
                    euser: root
                    processor: 3
                    resident: 793
                    tty: 0
                    nice: 0
                    pid: '1'
                    vm_size: 18372
                    sgroup: root
                    rgroup: root
                    fgroup: root
                    start_time: 1093372
                    tgid: 1
                    stime: 1
                    ppid: 0
                    share: 726
                    priority: 20
                    cmd: bash
                    agent_id: '000'
                  - scan:
                      id: 28643647
                      time: '2020-04-15T11:02:07Z'
                    name: wazuh-control
                    suser: root
                    nlwp: 1
                    pgrp: 1
                    state: S
                    session: 1
                    utime: 0
                    egroup: root
                    ruser: root
                    argvs: /var/ossec/bin/wazuh-control,restart
                    size: 1156
                    euser: root
                    processor: 6
                    resident: 457
                    tty: 0
                    nice: 0
                    pid: '15'
                    vm_size: 4624
                    sgroup: root
                    rgroup: root
                    fgroup: root
                    start_time: 1093547
                    tgid: 15
                    stime: 3
                    ppid: 1
                    share: 417
                    priority: 20
                    cmd: /bin/sh
                    agent_id: '000'
                  total_affected_items: 2
                  total_failed_items: 0
                  failed_items: []
                message: All specified syscollector information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /experimental/syscollector/hotfixes:
    get:
      tags:
      - Experimental
      summary: Get agents hotfixes
      description: Return all agents (or a list of them) hotfixes info
      operationId: api.controllers.experimental_controller.get_hotfixes_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/syscollector:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/agents_list'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/hotfix'
      responses:
        '200':
          description: Return a list of agent's hotfix results
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseSyscollectorHotfixes'
              example:
                data:
                  affected_items:
                  - hotfix: KB2978691
                    scan:
                      id: 1708048540
                      time: '2019-10-30T16:09:35Z'
                  - hotfix: KC2978693
                    scan:
                      id: 1708048541
                      time: '2019-10-30T16:19:39Z'
                  total_affected_items: 2
                  total_failed_items: 0
                  failed_items: []
                message: All specified syscollector information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
components:
  schemas:
    ApiResponse:
      type: object
      properties:
        message:
          type: string
          description: Human readable description to explain the result of the request
    AllItemsResponse:
      type: object
      required:
      - total_affected_items
      - failed_items
      - total_failed_items
      properties:
        total_affected_items:
          type: integer
          format: int32
          description: Number of items that have successfully applied the requested
            operation
        failed_items:
          type: array
          description: List of items that have failed applying the requested operation
          items:
            $ref: '#/components/schemas/SimpleApiError'
        total_failed_items:
          type: integer
          format: int32
          description: Number of items that have failed applying the requested operation
    AllItemsResponseAgentIDs:
      allOf:
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/AgentID'
      - $ref: '#/components/schemas/AllItemsResponse'
    AllItemsResponseSyscollectorHardware:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/SyscollectorHardware'
    AllItemsResponseSyscollectorHotfixes:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/SyscollectorHotfix'
    AllItemsResponseSyscollectorInterface:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/SyscollectorInterface'
    AllItemsResponseSyscollectorOS:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/SyscollectorOS'
    AllItemsResponseSyscollectorPackages:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/SyscollectorPackages'
    AllItemsResponseSyscollectorPorts:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/SyscollectorPorts'
    AllItemsResponseSyscollectorProcesses:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/SyscollectorProcess'
    AllItemsResponseSyscollectorProtocol:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/SyscollectorProtocol'
    AllItemsResponseSyscollectorNetwork:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/SyscollectorNetwork'
    AllItemsResponseCiscatResult:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/CiscatResults'
  responses:
    ResponseError:
      description: Response to report a bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Bad Request
            detail: '''{invalid_param}'' is not a ''{expected_type}''. Failed validating
              ''format'' in schema[''items'']: {''description'': ''{parameter_name}'',
              ''format'': ''{expected_format}'', ''minLength'': {expected_length},
              ''type'': ''{expected_type}'', ''x-scope'': ['''', ''#/components/parameters/{parameter_name}'']}'
    PermissionDeniedResponse:
      description: Response to report a permission denied request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            title: Permission Denied
            detail: 'Permission denied: Resource type: *:*'
            remediation: Please, make sure you have permissions to execute the current
              request. For more information on how to set up permissions, please visit
              https://documentation.wazuh.com/4.9/user-manual/api/rbac/configuration.html
            error: 4000
            dapi_errors:
              unknown-node:
                error: 'Permission denied: Resource type: *:*'
    UnauthorizedResponse:
      description: Response to report an unauthorized request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Unauthorized
            detail: No authorization token provided
    InvalidHTTPMethodResponse:
      description: Response to report an invalid HTTP method
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Method Not Allowed
            detail: Specified method is invalid for this resource
    TooManyRequestsResponse:
      description: Maximum number of request per minute reached
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Wazuh Error
            detail: Maximum number of requests per minute reached
            remediation: 'This limit can be changed in api.yaml file. More information
              here: https://documentation.wazuh.com/4.9/user-manual/api/security/configuration.html'
            code: 6001
  parameters:
    benchmark:
      in: query
      name: benchmark
      description: Filter by benchmark type
      schema:
        type: string
        format: alphanumeric
    error:
      in: query
      name: error
      description: Filter by encountered errors
      schema:
        type: integer
        format: int32
        minimum: 0
    fail:
      in: query
      name: fail
      description: Filter by failed checks
      schema:
        type: integer
        format: int32
        minimum: 0
    file_format:
      in: query
      name: format
      description: Filter by file format. For example 'deb' will output deb files
      schema:
        type: string
        format: alphanumeric
    hotfix:
      in: query
      name: hotfix
      description: Filter by hotfix
      schema:
        type: string
    limit:
      in: query
      name: limit
      description: 'Maximum number of elements to return. Although up to 100.000 can
        be specified, it is recommended not to exceed 500 elements. Responses may
        be slower the more this number is exceeded. '
      schema:
        type: integer
        format: int32
        default: 500
        minimum: 1
        maximum: 100000
    agents_list:
      in: query
      name: agents_list
      description: List of agent IDs (separated by comma), all agents selected by
        default if not specified
      schema:
        type: array
        items:
          $ref: '#/components/schemas/AgentID'
    agents_list_all:
      in: query
      name: agents_list
      description: List of agent IDs (separated by comma), use the keyword `all` to
        select all agents
      required: true
      schema:
        type: array
        items:
          $ref: '#/components/schemas/AgentIDListAll'
    name:
      in: query
      name: name
      description: Filter by name
      schema:
        type: string
        format: alphanumeric
    notchecked:
      in: query
      name: notchecked
      description: Filter by not checked
      schema:
        type: integer
        format: int32
        minimum: 0
    offset:
      in: query
      name: offset
      description: First element to return in the collection
      schema:
        type: integer
        format: int32
        default: 0
        minimum: 0
    pass:
      in: query
      name: pass
      description: Filter by passed checks
      schema:
        type: integer
        format: int32
        minimum: 0
    pretty:
      in: query
      name: pretty
      description: Show results in human-readable format
      schema:
        type: boolean
        default: false
    process:
      in: query
      name: process
      description: Filter by process name
      schema:
        type: string
        format: alphanumeric
    profile:
      in: query
      name: profile
      description: Filter by evaluated profile
      schema:
        type: string
        format: alphanumeric
    score:
      in: query
      name: score
      description: Filter by final score
      schema:
        type: integer
        format: int32
        minimum: 0
    search:
      in: query
      name: search
      description: Look for elements containing the specified string. To obtain a
        complementary search, use '-' at the beginning
      schema:
        type: string
        format: search
    select:
      in: query
      name: select
      description: 'Select which fields to return (separated by comma). Use ''.''
        for nested fields. For example, ''{field1: field2}'' may be selected with
        ''field1.field2'''
      schema:
        type: array
        items:
          type: string
          format: names
    sort:
      in: query
      name: sort
      description: 'Sort the collection by a field or fields (separated by comma).
        Use +/- at the beggining to list in ascending or descending order. Use ''.''
        for nested fields. For example, ''{field1: field2}'' may be selected with
        ''field1.field2'''
      schema:
        type: string
        format: sort
    type_syscollector:
      in: query
      name: type
      description: Type of network
      schema:
        type: string
        format: alphanumeric
    unknown:
      in: query
      name: unknown
      description: Filter by unknown results
      schema:
        type: integer
        format: int32
    version:
      in: query
      name: version
      description: 'Filter by agents version using one of the following formats: ''X.Y.Z'',
        ''vX.Y.Z'', ''wazuh X.Y.Z'' or ''wazuh vX.Y.Z''. For example: ''4.4.0'''
      schema:
        type: string
        format: alphanumeric
    wait_for_complete:
      in: query
      name: wait_for_complete
      description: Disable timeout response
      schema:
        type: boolean
        default: false
    ram.free:
      in: query
      name: ram.free
      description: Filter by ram.free
      schema:
        type: integer
        format: int64
        minimum: 0
    ram.total:
      in: query
      name: ram.total
      description: Filter by ram.total
      schema:
        type: integer
        format: int64
        minimum: 0
    cpu.cores:
      in: query
      name: cpu.cores
      description: Filter by cpu.cores
      schema:
        type: integer
        format: int32
        minimum: 1
    cpu.mhz:
      in: query
      name: cpu.mhz
      description: Filter by cpu.mhz
      schema:
        type: number
        format: float
        minimum: 1
    cpu.name:
      in: query
      name: cpu.name
      description: Filter by cpu.name
      schema:
        type: string
    board_serial:
      in: query
      name: board_serial
      description: Filter by board_serial
      schema:
        type: string
        format: alphanumeric
    proto:
      in: query
      name: proto
      description: Filter by IP protocol
      schema:
        type: string
        format: alphanumeric
    address:
      in: query
      name: address
      description: Filter by IP address
      schema:
        type: string
        format: alphanumeric
    broadcast:
      in: query
      name: broadcast
      description: Filter by broadcast direction
      schema:
        type: string
        format: alphanumeric
    netmask:
      in: query
      name: netmask
      description: Filter by netmask
      schema:
        type: string
        format: alphanumeric
    adapter:
      in: query
      name: adapter
      description: Filter by adapter
      schema:
        type: string
        format: alphanumeric
    state:
      in: query
      name: state
      description: Filter by state
      schema:
        type: string
        format: alphanumeric
    mtu:
      in: query
      name: mtu
      description: Filter by mtu
      schema:
        type: integer
        format: int32
        minimum: 0
    tx.packets:
      in: query
      name: tx.packets
      description: Filter by tx.packets
      schema:
        type: integer
        format: int32
        minimum: 0
    rx.packets:
      in: query
      name: rx.packets
      description: Filter by rx.packets
      schema:
        type: integer
        format: int32
        minimum: 0
    tx.bytes:
      in: query
      name: tx.bytes
      description: Filter by tx.bytes
      schema:
        type: integer
        format: int32
        minimum: 0
    rx.bytes:
      in: query
      name: rx.bytes
      description: Filter by rx.bytes
      schema:
        type: integer
        format: int32
        minimum: 0
    tx.errors:
      in: query
      name: tx.errors
      description: Filter by tx.errors
      schema:
        type: integer
        format: int32
        minimum: 0
    rx.errors:
      in: query
      name: rx.errors
      description: Filter by rx.errors
      schema:
        type: integer
        format: int32
        minimum: 0
    tx.dropped:
      in: query
      name: tx.dropped
      description: Filter by tx.dropped
      schema:
        type: integer
        format: int32
        minimum: 0
    rx.dropped:
      in: query
      name: rx.dropped
      description: Filter by rx.dropped
      schema:
        type: integer
        format: int32
        minimum: 0
    iface:
      in: query
      name: iface
      description: Filter by network interface
      schema:
        type: string
        format: alphanumeric
    gateway:
      in: query
      name: gateway
      description: Filter by network gateway
      schema:
        type: string
        format: alphanumeric
    dhcp:
      in: query
      name: dhcp
      description: Filter by network dhcp (enabled or disabled)
      schema:
        $ref: '#/components/schemas/DHCPStatus'
    os.name:
      in: query
      name: os.name
      description: Filter by OS name
      schema:
        type: string
        format: alphanumeric
    architecture:
      in: query
      name: architecture
      description: Filter by architecture
      schema:
        type: string
        format: alphanumeric
    os.version:
      in: query
      name: os.version
      description: Filter by OS version
      schema:
        type: string
        format: alphanumeric
    release:
      in: query
      name: release
      description: Filter by release
      schema:
        type: string
        format: alphanumeric
    vendor:
      in: query
      name: vendor
      description: Filter by vendor
      schema:
        type: string
    pid:
      in: query
      name: pid
      description: Filter by pid
      schema:
        type: string
        format: numbers
    protocol:
      in: query
      name: protocol
      description: Filter by protocol
      schema:
        type: string
        format: alphanumeric
    local.ip:
      in: query
      name: local.ip
      description: Filter by Local IP
      schema:
        type: string
        format: alphanumeric
    local.port:
      in: query
      name: local.port
      description: Filter by Local Port
      schema:
        type: string
        format: numbers
    remote.ip:
      in: query
      name: remote.ip
      description: Filter by Remote IP
      schema:
        type: string
        format: alphanumeric
    tx_queue:
      in: query
      name: tx_queue
      description: Filter by tx_queue
      schema:
        type: string
        format: numbers
    process_pid:
      in: query
      name: pid
      description: Filter by process pid
      schema:
        type: string
        format: numbers
    process_state:
      in: query
      name: state
      description: Filter by process state
      schema:
        type: string
        format: alphanumeric
    ppid:
      in: query
      name: ppid
      description: Filter by process parent pid
      schema:
        type: string
        format: numbers
    egroup:
      in: query
      name: egroup
      description: Filter by process egroup
      schema:
        type: string
        format: alphanumeric
    euser:
      in: query
      name: euser
      description: Filter by process euser
      schema:
        type: string
        format: alphanumeric
    fgroup:
      in: query
      name: fgroup
      description: Filter by process fgroup
      schema:
        type: string
        format: alphanumeric
    process_name:
      in: query
      name: name
      description: Filter by process name
      schema:
        type: string
        format: alphanumeric
    nlwp:
      in: query
      name: nlwp
      description: Filter by process nlwp
      schema:
        type: string
        format: numbers
    pgrp:
      in: query
      name: pgrp
      description: Filter by process pgrp
      schema:
        type: string
        format: numbers
    priority:
      in: query
      name: priority
      description: Filter by process priority
      schema:
        type: string
        format: numbers
    rgroup:
      in: query
      name: rgroup
      description: Filter by process rgroup
      schema:
        type: string
        format: alphanumeric
    ruser:
      in: query
      name: ruser
      description: Filter by process ruser
      schema:
        type: string
        format: alphanumeric
    sgroup:
      in: query
      name: sgroup
      description: Filter by process sgroup
      schema:
        type: string
        format: alphanumeric
    suser:
      in: query
      name: suser
      description: Filter by process suser
      schema:
        type: string
        format: alphanumeric
    package_version:
      in: query
      name: version
      description: Filter by package version
      schema:
        type: string
