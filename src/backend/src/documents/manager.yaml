openapi: 3.0.0
paths:
  /manager/status:
    get:
      tags:
      - Manager
      summary: Get status
      description: Return the status of all Wazuh daemons
      operationId: api.controllers.manager_controller.get_status
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Wazuh manager daemons statuses
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/WazuhDaemonsStatus'
              example:
                data:
                  affected_items:
                  - wazuh-agentlessd: stopped
                    wazuh-analysisd: running
                    wazuh-authd: running
                    wazuh-csyslogd: stopped
                    wazuh-dbd: stopped
                    wazuh-monitor": running
                    wazuh-execd: running
                    wazuh-integratord: stopped
                    wazuh-logcollector: running
                    wazuh-maild: stopped
                    wazuh-remoted: running
                    wazuh-reportd: stopped
                    wazuh-syscheckd: running
                    wazuh-clusterd: running
                    wazuh-modulesd: running
                    wazuh-db: running
                    wazuh-apid: running
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Processes status was successfully read in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/info:
    get:
      tags:
      - Manager
      summary: Get information
      description: Return basic information such as version, compilation date, installation
        path
      operationId: api.controllers.manager_controller.get_info
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Manager information
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/WazuhInfo'
              example:
                data:
                  affected_items:
                  - path: /var/ossec
                    version: v4.3.0
                    type: server
                    max_agents: unlimited
                    openssl_support: true
                    tz_offset: 0
                    tz_name: UTC
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Basic information was successfully read in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/configuration:
    get:
      tags:
      - Manager
      summary: Get configuration
      description: Return wazuh configuration used. The 'section' and 'field' parameters
        will be ignored if 'raw' parameter is provided.
      operationId: api.controllers.manager_controller.get_configuration
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/raw'
      - $ref: '#/components/parameters/section'
      - $ref: '#/components/parameters/field'
      - $ref: '#/components/parameters/distinct'
      responses:
        '200':
          description: Wazuh configuration
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/WazuhManagerConfiguration'
            application/xml:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/WazuhManagerConfiguration'
              example:
                data:
                  affected_items:
                  - global:
                      jsonout_output: true
                      alerts_log: true
                      logall: false
                      logall_json: false
                      email_notification: false
                      smtp_server: smtp.example.wazuh.com
                      email_from: wazuh@example.wazuh.com
                      email_to: recipient@example.wazuh.com
                      email_maxperhour: 12
                      email_log_source: alerts.log
                      queue_size: 131072
                      update_check: true
                      white_list:
                      - 127.0.0.1
                      - ^localhost.localdomain$
                      - 127.0.0.53
                    alerts:
                      log_alert_level: '3'
                      email_alert_level: '12'
                    cis-cat:
                      disabled: true
                      timeout: 1800
                      interval: 1d
                      scan-on-start: true
                      java_path: wodles/java
                      ciscat_path: wodles/ciscat
                    command:
                    - name: disable-account
                      executable: disable-account.sh
                      expect: user
                      timeout_allowed: true
                    - name: restart-ossec
                      executable: restart-ossec.sh
                  total_affected_items: 1
                  failed_items: []
                  total_failed_items: 0
                message: Configuration was successfully read
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
    put:
      tags:
      - Manager
      summary: Update Wazuh configuration
      description: Replace Wazuh configuration with the data contained in the API
        request
      operationId: api.controllers.manager_controller.update_configuration
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:update_config'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      requestBody:
        description: Content of the ossec.conf to be uploaded
        required: true
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
      responses:
        '200':
          description: Confirmation message
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - $ref: '#/components/schemas/ConfirmationMessage'
              example:
                message: Configuration was successfully updated
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '406':
          $ref: '#/components/responses/WrongContentTypeResponse'
        '413':
          $ref: '#/components/responses/RequestTooLargeResponse'
        '415':
          $ref: '#/components/responses/UnsupportedMediaTypeResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/daemons/stats:
    get:
      tags:
      - Manager
      summary: Get Wazuh daemon stats
      description: Return Wazuh statistical information from specified daemons
      operationId: api.controllers.manager_controller.get_daemon_stats
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/daemons_list'
      responses:
        '200':
          description: Wazuh daemon stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhDaemonStats'
              example:
                data:
                  affected_items:
                  - uptime: 2022-07-21 10:09:20+00:00
                    timestamp: 2022-07-21 10:48:32+00:00
                    name: wazuh-remoted
                    metrics:
                      bytes:
                        received: 0
                        sent: 0
                      keys_reload_count: 0
                      messages:
                        received_breakdown:
                          control: 0
                          control_breakdown:
                            keepalive: 0
                            request: 0
                            shutdown: 0
                            startup: 0
                          dequeued_after: 0
                          discarded: 0
                          event: 0
                          ping: 0
                          unknown: 0
                        sent_breakdown:
                          ack: 0
                          ar: 0
                          discarded: 0
                          request: 0
                          sca: 0
                          shared: 0
                      queues:
                        received:
                          size: 131072
                          usage: 0
                      tcp_sessions: 0
                  total_affected_items: 1
                  failed_items: []
                  total_failed_items: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/stats:
    get:
      tags:
      - Manager
      summary: Get stats
      description: Return Wazuh statistical information for the current or specified
        date
      operationId: api.controllers.manager_controller.get_stats
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/date'
      responses:
        '200':
          description: Wazuh stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - hour: 15
                    alerts:
                    - sigid: 5303
                      level: 3
                      times: 1
                    - sigid: 5501
                      level: 3
                      times: 4
                    - sigid: 221
                      level: 0
                      times: 653
                    totalAlerts: 658
                    events: 4387
                    firewall: 0
                  - hour: 16
                    alerts:
                    - sigid: 5521
                      level: 0
                      times: 1
                    - sigid: 530
                      level: 0
                      times: 120
                    totalAlerts: 121
                    events: 4379
                    syscheck: 0
                    firewall: 0
                  total_affected_items: 2
                  failed_items: []
                  total_failed_items: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/stats/hourly:
    get:
      tags:
      - Manager
      summary: Get stats hour
      description: Return Wazuh statistical information per hour. Each number in the
        averages field represents the average of alerts per hour
      operationId: api.controllers.manager_controller.get_stats_hourly
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Wazuh hourly stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - averages:
                    - 40
                    - 24
                    - 67
                    - 234
                    - 66
                    - 24
                    - 634
                    - 66
                    - 123
                    - 56
                    - 65
                    - 23
                    - 666
                    - 233
                    - 646
                    - 44
                    - 64
                    - 99
                    - 34
                    - 235
                    - 653
                    - 25
                    - 65
                    - 23
                    interactions: 0
                  total_affected_items: 1
                  failed_items: []
                  total_failed_items: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/stats/weekly:
    get:
      tags:
      - Manager
      summary: Get stats week
      description: Return Wazuh statistical information per week. Each number in the
        averages field represents the average of alerts per hour for that specific
        day
      operationId: api.controllers.manager_controller.get_stats_weekly
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Wazuh weekly stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - Sun:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Mon:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Tue:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Wed:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Thu:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Fri:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Sat:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  total_affected_items: 7
                  failed_items: []
                  total_failed_items: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/stats/analysisd:
    get:
      tags:
      - Manager
      deprecated: true
      summary: Get stats analysisd
      description: Return Wazuh analysisd statistical information
      operationId: api.controllers.manager_controller.get_stats_analysisd
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Wazuh analysisd stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - total_events_decoded: 113.0
                    syscheck_events_decoded: 2.0
                    syscollector_events_decoded: 0.0
                    rootcheck_events_decoded: 4.0
                    sca_events_decoded: 2.0
                    winevt_events_decoded: 0.0
                    dbsync_messages_dispatched: 55.0
                    other_events_decoded: 50.0
                    events_processed: 57.0
                    events_received: 114.0
                    events_dropped: 0.0
                    alerts_written: 3.0
                    firewall_written: 0.0
                    fts_written: 0.0
                    syscheck_queue_usage: 0.0
                    syscheck_queue_size: 16384.0
                    syscollector_queue_usage: 0.0
                    syscollector_queue_size: 16384.0
                    rootcheck_queue_usage: 0.0
                    rootcheck_queue_size: 16384.0
                    sca_queue_usage: 0.0
                    sca_queue_size: 16384.0
                    hostinfo_queue_usage: 0.0
                    hostinfo_queue_size: 16384.0
                    winevt_queue_usage: 0.0
                    winevt_queue_size: 16384.0
                    dbsync_queue_usage: 0.0
                    dbsync_queue_size: 16384.0
                    upgrade_queue_usage: 0.0
                    upgrade_queue_size: 16384.0
                    event_queue_usage: 0.0
                    event_queue_size: 16384.0
                    rule_matching_queue_usage: 0.0
                    rule_matching_queue_size: 16384.0
                    alerts_queue_usage: 0.0
                    alerts_queue_size: 16384.0
                    firewall_queue_usage: 0.0
                    firewall_queue_size: 16384.0
                    statistical_queue_usage: 0.0
                    statistical_queue_size: 16384.0
                    archives_queue_usage: 0.0
                    archives_queue_size: 16384.0
                  total_affected_items: 1
                  failed_items: []
                  total_failed_items: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/stats/remoted:
    get:
      tags:
      - Manager
      deprecated: true
      summary: Get stats remoted
      description: Return Wazuh remoted statistical information
      operationId: api.controllers.manager_controller.get_stats_remoted
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Wazuh remoted stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - queue_size: 0.0
                    total_queue_size: 131072.0
                    tcp_sessions: 4.0
                    evt_count: 9089.0
                    ctrl_msg_count: 2099.0
                    discarded_count: 0.0
                    sent_bytes: 784598.0
                    recv_bytes: 4541779.0
                    dequeued_after_close: 0.0
                  total_affected_items: 0
                  failed_items: []
                  total_failed_items: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/logs:
    get:
      tags:
      - Manager
      summary: Get logs
      description: Return the last 2000 wazuh log entries
      operationId: api.controllers.manager_controller.get_log
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/log_lines'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/tag'
      - $ref: '#/components/parameters/log_level'
      - $ref: '#/components/parameters/query'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/distinct'
      responses:
        '200':
          description: Wazuh logs
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhLogs'
              example:
                data:
                  affected_items:
                  - timestamp: '2020-04-15T14:47:54Z'
                    tag: wazuh-modulesd:syscollector
                    level: info
                    description: Start syscheck scan
                  - timestamp: '2020-04-15T14:47:51Z'
                    tag: wazuh-modulesd:syscollector
                    level: info
                    description: Starting evaluation
                  - timestamp: '2020-04-15T13:50:24Z'
                    tag: wazuh-maild
                    level: error
                    description: ' (1263): Error Sending email to 69.172.200.109 (smtp
                      server)'
                  total_affected_items: 3
                  failed_items: []
                  total_failed_items: 0
                message: Logs read successfully in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/logs/summary:
    get:
      tags:
      - Manager
      summary: Get logs summary
      description: Return a summary of the last 2000 wazuh log entries
      operationId: api.controllers.manager_controller.get_log_summary
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Wazuh logs summary
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/WazuhLogsSummary'
              example:
                data:
                  affected_items:
                  - indexer-connector:
                      all: 24
                      info: 0
                      error: 0
                      critical: 0
                      warning: 24
                      debug: 0
                  - wazuh-db:
                      info: 1
                      all: 4
                      critical: 0
                      debug: 0
                      error: 3
                      warning: 0
                  - wazuh-modulesd:content_manager:
                      info: 1
                      all: 1
                      critical: 0
                      debug: 0
                      error: 0
                      warning: 0
                  - wazuh-modulesd:router:
                      info: 1
                      all: 1
                      critical: 0
                      debug: 0
                      error: 0
                      warning: 0
                  - wazuh-remoted:
                      info: 744
                      all: 0
                      critical: 0
                      debug: 744
                      error: 0
                      warning: 0
                  total_affected_items: 5
                  failed_items: []
                  total_failed_items: 0
                message: Log was successfully summarized in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/api/config:
    get:
      tags:
      - Manager
      summary: Get API config
      description: Return the local API configuration in JSON format
      operationId: api.controllers.manager_controller.get_api_config
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read_api_config'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Current API configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                data:
                  affected_items:
                  - node_name: manager
                    node_api_config:
                      host: 0.0.0.0
                      port: 55000
                      drop_privileges: true
                      experimental_features: false
                      max_upload_size: 10485760
                      intervals:
                        request_timeout: 10
                      https:
                        enabled: true
                        key: /var/ossec/api/configuration/ssl/server.key
                        cert: /var/ossec/api/configuration/ssl/server.crt
                        use_ca: false
                        ca: /var/ossec/api/configuration/ssl/ca.crt
                        ssl_protocol: auto
                        ssl_ciphers: ''
                      logs:
                        level: info
                        format: plain
                        max_size:
                          enabled: false
                          size: 1M
                      cors:
                        enabled: false
                        source_route: '*'
                        expose_headers: '*'
                        allow_headers: '*'
                        allow_credentials: false
                      cache:
                        enabled: true
                        time: 0.75
                      access:
                        max_login_attempts: 50
                        block_time: 300
                        max_request_per_minute: 300
                      upload_configuration:
                        remote_commands:
                          localfile:
                            enabled: true
                            exceptions: []
                          wodle_commands:
                            enabled: true
                            exceptions: []
                        limits:
                          eps:
                            allow: true
                        agents:
                          allow_higher_versions: true
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: API configuration was successfully read
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/restart:
    put:
      tags:
      - Manager
      summary: Restart manager
      description: Restart the wazuh manager
      operationId: api.controllers.manager_controller.put_restart
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      - $ref: '#/x-rbac-catalog/actions/manager:restart'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Confirmation message
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                data:
                  affected_items:
                  - master-node
                  total_affected_items: 1
                  failed_items: []
                  total_failed_items: 0
                message: Restart request sent to all specified nodes
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/configuration/validation:
    get:
      tags:
      - Manager
      summary: Check config
      description: Return whether the Wazuh configuration is correct
      operationId: api.controllers.manager_controller.get_conf_validation
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: OK message if configuration is right
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigurationValidation'
              example:
                data:
                  affected_items:
                  - name: master-node
                    status: OK
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Validation was successfully checked in all nodes
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/configuration/{component}/{configuration}:
    get:
      tags:
      - Manager
      summary: Get active configuration
      description: Return the requested active configuration in JSON format
      operationId: api.controllers.manager_controller.get_manager_config_ondemand
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/manager:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/component'
      - $ref: '#/components/parameters/configuration'
      responses:
        '200':
          description: Manager configuration on-demand
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
              example:
                data:
                  affected_items:
                  - name: wazuh
                    node_name: master-node
                    node_type: master
                    key: 9d273b53510fef702b54a92e9cffc82e
                    port: 1516
                    bind_addr: 0.0.0.0
                    nodes:
                    - wazuh-master
                    hidden: false
                    disabled: false
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Active configuration was successfully read in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /manager/version/check:
    get:
      tags:
      - Manager
      summary: Check available updates
      description: Return if there is any available update
      operationId: api.controllers.manager_controller.check_available_version
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/force_query'
      responses:
        '200':
          description: Information about available new versions
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/NewVersions'
              example:
                data:
                  last_check_date: '2023-10-09T15:39:57.616301+00:00'
                  current_version: v4.8.0
                  update_check: true
                  last_available_major:
                    tag: v5.0.0
                    description: ''
                    title: Wazuh 5.0.0
                    published_date: '2023-10-05T12:48:00Z'
                    semver:
                      major: 5
                      minor: 0
                      patch: 0
                  last_available_minor:
                    tag: v4.9.1
                    description: ''
                    title: Wazuh 4.9.1
                    published_date: '2023-10-05T12:47:00Z'
                    semver:
                      major: 4
                      minor: 9
                      patch: 1
                  last_available_patch:
                    tag: v4.8.2
                    description: ''
                    title: Wazuh 4.8.2
                    published_date: '2023-10-05T12:46:00Z'
                    semver:
                      major: 4
                      minor: 8
                      patch: 2
                  uuid": edc90f7f-fca4-446c-8985-e69520948e42
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '404':
          $ref: '#/components/responses/ResourceNotFoundResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
components:
  schemas:
    ApiResponse:
      type: object
      properties:
        message:
          type: string
          description: Human readable description to explain the result of the request
    AllItemsResponseWazuhDaemonStats:
      allOf:
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              oneOf:
              - $ref: '#/components/schemas/WazuhRemotedStatsItem'
              - $ref: '#/components/schemas/WazuhAnalysisdStatsItem'
              - $ref: '#/components/schemas/WazuhDBStatsItem'
      - $ref: '#/components/schemas/AllItemsResponse'
    AllItemsResponseWazuhLogs:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/WazuhLogs'
    AllItemsResponseWazuhStats:
      allOf:
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              anyOf:
              - $ref: '#/components/schemas/WazuhStats'
              - $ref: '#/components/schemas/WazuhHourlyStats'
              - $ref: '#/components/schemas/WazuhWeeklyStats'
              - $ref: '#/components/schemas/WazuhAnalysisdStats'
              - $ref: '#/components/schemas/WazuhRemotedStats'
      - $ref: '#/components/schemas/AllItemsResponse'
    WazuhDaemonsStatus:
      type: object
      properties:
        wazuh-agentlessd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-analysisd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-authd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-csyslogd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-dbd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-execd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-integratord:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-logcollector:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-maild:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-monitord:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-remoted:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-reportd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-syscheckd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-apid:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-clusterd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-db:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-modulesd:
          $ref: '#/components/schemas/DaemonStatus'
    WazuhInfo:
      type: object
      properties:
        path:
          type: string
          format: paths
          description: Wazuh installation path
        version:
          type: string
          description: Wazuh version
        type:
          type: string
          description: Wazuh installation type
          enum:
          - server
          - local
          - hybrid
        max_agents:
          type: string
          minimum: 0
          description: Maximum number of agents that can be registered.
        openssl_support:
          type: string
        tz_offset:
          type: string
        tz_name:
          type: string
    WazuhManagerConfiguration:
      type: object
      properties:
        active-response:
          type: array
          items:
            type: object
        agentless:
          type: array
          items:
            type: object
        alerts:
          type: object
        auth:
          type: object
        cluster:
          type: object
        command:
          type: array
          items:
            type: object
        database_output:
          type: object
        email_alerts:
          type: object
        gcp-pubsub:
          type: object
        global:
          type: object
        integration:
          type: array
          items:
            type: object
        labels:
          type: object
        localfile:
          type: array
          items:
            type: object
        logging:
          type: object
        remote:
          type: array
          items:
            type: object
        reports:
          type: object
        rootcheck:
          type: object
        ruleset:
          type: object
        sca:
          type: object
        socket:
          type: object
        syscheck:
          type: object
        syslog_output:
          type: array
          items:
            type: object
        aws-s3:
          type: object
        azure-logs:
          type: object
        cis-cat:
          type: object
        docker-listener:
          type: object
        open-scap:
          type: object
        osquery:
          type: object
        syscollector:
          type: object
    WazuhLogsSummary:
      type: object
      properties:
        indexer-connector:
          $ref: '#/components/schemas/LogSummary'
        wazuh-agentlessd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-analysisd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-authd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-csyslogd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-dbd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-execd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-integratord:
          $ref: '#/components/schemas/LogSummary'
        wazuh-maild:
          $ref: '#/components/schemas/LogSummary'
        wazuh-monitord:
          $ref: '#/components/schemas/LogSummary'
        wazuh-logcollector:
          $ref: '#/components/schemas/LogSummary'
        wazuh-remoted:
          $ref: '#/components/schemas/LogSummary'
        wazuh-reportd:
          $ref: '#/components/schemas/LogSummary'
        rootcheck:
          $ref: '#/components/schemas/LogSummary'
        wazuh-syscheckd:
          $ref: '#/components/schemas/LogSummary'
        sca:
          $ref: '#/components/schemas/LogSummary'
        wazuh-db:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:agent-upgrade:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:aws-s3:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:azure-logs:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:ciscat:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:control:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:command:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:content_manager:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:database:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:docker-listener:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:download:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:oscap:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:osquery:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:syscollector:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:vulnerability-scanner:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:task-manager:
          $ref: '#/components/schemas/LogSummary'
    ConfirmationMessage:
      type: object
      properties:
        message:
          type: string
          description: Confirmation message
    ConfigurationValidation:
      type: object
      properties:
        status:
          type: string
          description: Configuration status
          enum:
          - OK
    NewVersions:
      type: object
      properties:
        last_check_date:
          type: string
          description: Datetime of the last query to the CTI service
        current_version:
          type: string
          description: Current version in the format vX.Y.Z
        update_check:
          type: boolean
          description: Flag that indicates if the service is enabled
        last_available_major:
          type: object
          description: Information about the most recent available major update
          properties:
            tag:
              type: string
              description: Version in the format vX.Y.Z
            description:
              type: string
            title:
              type: string
            published_date:
              type: string
            semver:
              type: object
              properties:
                major:
                  type: integer
                  format: int32
                minor:
                  type: integer
                  format: int32
                patch:
                  type: integer
                  format: int32
        last_available_minor:
          type: object
          description: Information about the most recent available minor update
          properties:
            tag:
              type: string
              description: Version in the format vX.Y.Z
            description:
              type: string
            title:
              type: string
            published_date:
              type: string
            semver:
              type: object
              properties:
                major:
                  type: integer
                  format: int32
                minor:
                  type: integer
                  format: int32
                patch:
                  type: integer
                  format: int32
        last_available_patch:
          type: object
          description: Information about the most recent available patch update
          properties:
            tag:
              type: string
              description: Version in the format vX.Y.Z
            description:
              type: string
            title:
              type: string
            published_date:
              type: string
            semver:
              type: object
              properties:
                major:
                  type: integer
                  format: int32
                minor:
                  type: integer
                  format: int32
                patch:
                  type: integer
                  format: int32
        uuid:
          type: string
          description: Identifier of the Wazuh instance
  responses:
    ResponseError:
      description: Response to report a bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Bad Request
            detail: '''{invalid_param}'' is not a ''{expected_type}''. Failed validating
              ''format'' in schema[''items'']: {''description'': ''{parameter_name}'',
              ''format'': ''{expected_format}'', ''minLength'': {expected_length},
              ''type'': ''{expected_type}'', ''x-scope'': ['''', ''#/components/parameters/{parameter_name}'']}'
    PermissionDeniedResponse:
      description: Response to report a permission denied request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            title: Permission Denied
            detail: 'Permission denied: Resource type: *:*'
            remediation: Please, make sure you have permissions to execute the current
              request. For more information on how to set up permissions, please visit
              https://documentation.wazuh.com/4.9/user-manual/api/rbac/configuration.html
            error: 4000
            dapi_errors:
              unknown-node:
                error: 'Permission denied: Resource type: *:*'
    UnauthorizedResponse:
      description: Response to report an unauthorized request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Unauthorized
            detail: No authorization token provided
    InvalidHTTPMethodResponse:
      description: Response to report an invalid HTTP method
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Method Not Allowed
            detail: Specified method is invalid for this resource
    WrongContentTypeResponse:
      description: Response to report an invalid content-type
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Wazuh Error
            detail: The body type is not the one specified in the content-type
            error: 6002
    RequestTooLargeResponse:
      description: Maximum request body size exceeded
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Request Entity Too Large
            detail: Maximum request body size 1048576 exceeded, actual body size 1225245
    TooManyRequestsResponse:
      description: Maximum number of request per minute reached
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Wazuh Error
            detail: Maximum number of requests per minute reached
            remediation: 'This limit can be changed in api.yaml file. More information
              here: https://documentation.wazuh.com/4.9/user-manual/api/security/configuration.html'
            code: 6001
    ResourceNotFoundResponse:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            title: Resource Not Found
            detail: The group does not exist
            remediation: 'Please, use `GET /groups` to find all available groups:
              https://documentation.wazuh.com/4.9/user-manual/api/rbac/configuration.html'
            code: 1710
            dapi_errors:
              unknown-node:
                error: The group does not exist
    UnsupportedMediaTypeResponse:
      description: Unsupported media type
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            title: Unsupported media type
            detail: Invalid Content-type (application/json), expected ['application/octet-stream']
  parameters:
    component:
      in: path
      name: component
      description: Selected agent's component
      required: true
      schema:
        type: string
        enum:
        - agent
        - agentless
        - analysis
        - auth
        - com
        - csyslog
        - integrator
        - logcollector
        - mail
        - monitor
        - request
        - syscheck
        - wazuh-db
        - wmodules
    configuration:
      in: path
      name: configuration
      description: '<p>Selected agent''s configuration to read. The configuration
        to read depends on the selected component.

        The following table shows all available combinations of component and configuration
        values:</p>

        <table class="table table-striped table-bordered">

        <thead>

        <tr>

        <th>Component</th>

        <th>Configuration</th>

        <th>Tag</th>

        </tr>

        </thead>

        <tbody>

        <tr>

        <td>agent</td>

        <td>client</td>

        <td><code>&lt;client&gt;</code></td>

        </tr>

        <tr>

        <td>agent</td>

        <td>buffer</td>

        <td><code>&lt;client_buffer&gt;</code></td>

        </tr>

        <tr>

        <td>agent</td>

        <td>labels</td>

        <td><code>&lt;labels&gt;</code></td>

        </tr>

        <tr>

        <td>agent</td>

        <td>internal</td>

        <td><code>&lt;agent&gt;</code>, <code>&lt;monitord&gt;</code>, <code>&lt;remoted&gt;</code></td>

        </tr>

        <tr>

        <td>agentless</td>

        <td>agentless</td>

        <td><code>&lt;agentless&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>global</td>

        <td><code>&lt;global&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>active_response</td>

        <td><code>&lt;active-response&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>alerts</td>

        <td><code>&lt;alerts&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>command</td>

        <td><code>&lt;command&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>rules</td>

        <td><code>&lt;rule&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>decoders</td>

        <td><code>&lt;decoder&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>internal</td>

        <td><code>&lt;analysisd&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>rule_test</td>

        <td><code>&lt;rule_test&gt;</code></td>

        </tr>

        <tr>

        <td>auth</td>

        <td>auth</td>

        <td><code>&lt;auth&gt;</code></td>

        </tr>

        <tr>

        <td>com</td>

        <td>active-response</td>

        <td><code>&lt;active-response&gt;</code></td>

        </tr>

        <tr>

        <td>com</td>

        <td>logging</td>

        <td><code>&lt;logging&gt;</code></td>

        </tr>

        <tr>

        <td>com</td>

        <td>internal</td>

        <td><code>&lt;execd&gt;</code></td>

        </tr>

        <tr>

        <td>com</td>

        <td>cluster</td>

        <td><code>&lt;cluster&gt;</code></td>

        </tr>

        <tr>

        <td>csyslog</td>

        <td>csyslog</td>

        <td><code>&lt;csyslog_output&gt;</code></td>

        </tr>

        <tr>

        <td>integrator</td>

        <td>integration</td>

        <td><code>&lt;integration&gt;</code></td>

        </tr>

        <tr>

        <td>logcollector</td>

        <td>localfile</td>

        <td><code>&lt;localfile&gt;</code></td>

        </tr>

        <tr>

        <td>logcollector</td>

        <td>socket</td>

        <td><code>&lt;socket&gt;</code></td>

        </tr>

        <tr>

        <td>logcollector</td>

        <td>internal</td>

        <td><code>&lt;logcollector&gt;</code></td>

        </tr>

        <tr>

        <td>mail</td>

        <td>global</td>

        <td><code>&lt;global&gt;&lt;email...&gt;</code></td>

        </tr>

        <tr>

        <td>mail</td>

        <td>alerts</td>

        <td><code>&lt;email_alerts&gt;</code></td>

        </tr>

        <tr>

        <td>mail</td>

        <td>internal</td>

        <td><code>&lt;maild&gt;</code></td>

        </tr>

        <tr>

        <td>monitor</td>

        <td>global</td>

        <td><code>&lt;global&gt;</code></td>

        </tr>

        <tr>

        <td>monitor</td>

        <td>internal</td>

        <td><code>&lt;monitord&gt;</code></td>

        </tr>

        <tr>

        <td>monitor</td>

        <td>reports</td>

        <td><code>&lt;reports&gt;</code></td>

        </tr>

        <tr>

        <td>request</td>

        <td>global</td>

        <td><code>&lt;global&gt;</code></td>

        </tr>

        <tr>

        <td>request</td>

        <td>remote</td>

        <td><code>&lt;remote&gt;</code></td>

        </tr>

        <tr>

        <td>request</td>

        <td>internal</td>

        <td><code>&lt;remoted&gt;</code></td>

        </tr>

        <tr>

        <td>syscheck</td>

        <td>syscheck</td>

        <td><code>&lt;syscheck&gt;</code></td>

        </tr>

        <tr>

        <td>syscheck</td>

        <td>rootcheck</td>

        <td><code>&lt;rootcheck&gt;</code></td>

        </tr>

        <tr>

        <td>syscheck</td>

        <td>internal</td>

        <td><code>&lt;syscheck&gt;</code>, <code>&lt;rootcheck&gt;</code></td>

        </tr>

        <tr>

        <td>wazuh-db</td>

        <td>internal</td>

        <td><code>&lt;wazuh_db&gt;</code></td>

        </tr>

        <tr>

        <td>wazuh-db</td>

        <td>wdb</td>

        <td><code>&lt;wdb&gt;</code></td>

        </tr>

        <tr>

        <td>wmodules</td>

        <td>wmodules</td>

        <td><code>&lt;wodle&gt;</code></td>

        </tr>

        </tbody>

        </table>

        '
      required: true
      schema:
        type: string
        enum:
        - client
        - buffer
        - labels
        - internal
        - agentless
        - global
        - active_response
        - alerts
        - command
        - rules
        - decoders
        - auth
        - logging
        - reports
        - active-response
        - cluster
        - csyslog
        - integration
        - localfile
        - socket
        - remote
        - syscheck
        - rootcheck
        - wdb
        - wmodules
        - rule_test
    daemons_list:
      in: query
      name: daemons_list
      description: List of daemon names (separated by comma), all daemons selected
        by default if not specified
      schema:
        type: array
        items:
          type: string
          enum:
          - wazuh-analysisd
          - wazuh-remoted
          - wazuh-db
    log_lines:
      in: query
      name: limit
      description: Maximum number of lines to return.
      schema:
        type: integer
        format: int32
        default: 500
        minimum: 1
        maximum: 500
    offset:
      in: query
      name: offset
      description: First element to return in the collection
      schema:
        type: integer
        format: int32
        default: 0
        minimum: 0
    pretty:
      in: query
      name: pretty
      description: Show results in human-readable format
      schema:
        type: boolean
        default: false
    query:
      in: query
      name: q
      description: Query to filter results by. For example q=&quot;status=active&quot;
      schema:
        type: string
    raw:
      in: query
      name: raw
      description: Format response in plain text
      required: false
      schema:
        type: boolean
    search:
      in: query
      name: search
      description: Look for elements containing the specified string. To obtain a
        complementary search, use '-' at the beginning
      schema:
        type: string
        format: search
    select:
      in: query
      name: select
      description: 'Select which fields to return (separated by comma). Use ''.''
        for nested fields. For example, ''{field1: field2}'' may be selected with
        ''field1.field2'''
      schema:
        type: array
        items:
          type: string
          format: names
    sort:
      in: query
      name: sort
      description: 'Sort the collection by a field or fields (separated by comma).
        Use +/- at the beggining to list in ascending or descending order. Use ''.''
        for nested fields. For example, ''{field1: field2}'' may be selected with
        ''field1.field2'''
      schema:
        type: string
        format: sort
    wait_for_complete:
      in: query
      name: wait_for_complete
      description: Disable timeout response
      schema:
        type: boolean
        default: false
    section:
      in: query
      name: section
      description: Indicates the wazuh configuration section
      schema:
        type: string
        enum:
        - active-response
        - agentless
        - alerts
        - auth
        - client
        - client_buffer
        - cluster
        - command
        - database_output
        - email_alerts
        - global
        - integration
        - labels
        - localfile
        - logging
        - remote
        - reports
        - rootcheck
        - ruleset
        - sca
        - socket
        - syscheck
        - syslog_output
        - vulnerability-detection
        - indexer
        - aws-s3
        - azure-logs
        - cis-cat
        - docker-listener
        - open-scap
        - osquery
        - syscollector
    field:
      in: query
      name: field
      description: 'Indicate a section child. E.g, fields for *ruleset* section are:
        decoder_dir, rule_dir, etc'
      schema:
        type: string
        format: names
    date:
      in: query
      name: date
      description: Date to obtain statistical information from. Format YYYY-MM-DD
      schema:
        type: string
        format: date
    tag:
      in: query
      name: tag
      description: Wazuh component that logged the event
      schema:
        type: string
        format: alphanumeric
    log_level:
      in: query
      name: level
      description: Filter by log level
      schema:
        type: string
        enum:
        - critical
        - debug
        - debug2
        - error
        - info
        - warning
    distinct:
      in: query
      name: distinct
      description: Look for distinct values.
      schema:
        type: boolean
        default: false
    force_query:
      in: query
      name: force_query
      description: Force query to CTI service
      schema:
        type: boolean
        default: false
