openapi: 3.0.0
paths:
  /cluster/local/info:
    get:
      tags:
      - Cluster
      summary: Get local node info
      description: Return basic information about the cluster node receiving the request
      operationId: api.controllers.cluster_controller.get_cluster_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Node basic information
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - $ref: '#/components/schemas/ClusterLocalInfo'
              example:
                data:
                  affected_items:
                  - node: master-node
                    cluster: wazuh
                    type: master
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: All selected information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/local/config:
    get:
      tags:
      - Cluster
      summary: Get local node config
      description: Return the current node cluster configuration
      operationId: api.controllers.cluster_controller.get_config
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Cluster configuration
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - $ref: '#/components/schemas/ClusterLocalConfig'
              example:
                data:
                  affected_items:
                  - name: wazuh
                    node_name: master-node
                    node_type: master
                    key: 9d273b53510fef702b54a92e9cffc82e
                    port: 1516
                    bind_addr: 0.0.0.0
                    nodes:
                    - wazuh-master
                    hidden: 'no'
                    disabled: false
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: All selected information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/nodes:
    get:
      tags:
      - Cluster
      summary: Get nodes info
      description: Get information about all nodes in the cluster or a list of them
      operationId: api.controllers.cluster_controller.get_cluster_nodes
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/node_type'
      - $ref: '#/components/parameters/nodes_list'
      - $ref: '#/components/parameters/query'
      - $ref: '#/components/parameters/distinct'
      responses:
        '200':
          description: List of connected nodes
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseClusterNodes'
              example:
                data:
                  affected_items:
                  - name: master-node
                    type: master
                    version: 4.4.0
                    ip: wazuh-master
                  - name: worker1
                    type: worker
                    version: 4.4.0
                    ip: 172.26.0.7
                  - name: worker2
                    type: worker
                    version: 4.4.0
                    ip: 172.26.0.6
                  total_affected_items: 3
                  total_failed_items: 0
                  failed_items: []
                message: All selected nodes information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/healthcheck:
    get:
      tags:
      - Cluster
      summary: Get nodes healthcheck
      description: Return cluster healthcheck information for all nodes or a list
        of them. Such information includes last keep alive, last synchronization time
        and number of agents reporting on each node
      operationId: api.controllers.cluster_controller.get_healthcheck
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/nodes_list'
      responses:
        '200':
          description: Health information for cluster nodes
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseNodeHealthcheck'
              example:
                data:
                  affected_items:
                  - info:
                      name: master-node
                      type: master
                      version: 4.4.0
                      ip: wazuh-master
                      n_active_agents: 5
                  - info:
                      name: worker1
                      type: worker
                      version: 4.4.0
                      ip: 172.21.0.7
                      n_active_agents: 3
                    status:
                      sync_integrity_free: true
                      last_check_integrity:
                        date_start_master: 2021-05-27 10:50:51.325656+00:00
                        date_end_master: 2021-05-27 10:50:51.342140+00:00
                      last_sync_integrity:
                        date_start_master: 2021-05-27 10:48:54.086973+00:00
                        tmp_date_start_master: 2021-05-27 10:48:54.086973+00:00
                        date_end_master: 2021-05-27 10:48:54.093328+00:00
                        total_extra_valid: 0
                        total_files:
                          missing: 2
                          extra: 0
                          extra_valid: 0
                          shared: 0
                      sync_agent_info_free: true
                      last_sync_agentgroup:
                        date_start: 2021-05-27 10:48:54.086973+00:00
                        date_end: 2021-05-27 10:49:52.075794+00:00
                        n_synced_chunks: 1
                      last_sync_full_agentgroup:
                        date_start: 2021-05-27 10:52:48.038573+00:00
                        date_end: 2021-05-27 10:53:23.057795+00:00
                        n_synced_chunks: 2
                      last_sync_agentinfo:
                        date_start_master: 2021-05-27 10:50:49.174463+00:00
                        date_end_master: 2021-05-27 10:50:49.175921+00:00
                        n_synced_chunks: 1
                      last_keep_alive: 2021-05-27 10:50:08.985208+00:00
                  - info:
                      name: worker2
                      type: worker
                      version: 4.4.0
                      ip: 172.21.0.6
                      n_active_agents: 1
                    status:
                      sync_integrity_free: true
                      last_check_integrity:
                        date_start_master: 2021-05-27 10:50:51.939323+00:00
                        date_end_master: 2021-05-27 10:50:51.955007+00:00
                      last_sync_integrity:
                        date_start_master: 2021-05-27 10:48:54.706395+00:00
                        tmp_date_start_master: 2021-05-27 10:48:54.706395+00:00
                        date_end_master: 2021-05-27 10:48:54.726944+00:00
                        total_extra_valid: 0
                        total_files:
                          missing: 2
                          extra: 0
                          extra_valid: 0
                          shared: 0
                      sync_agent_info_free: true
                      last_sync_agentgroup:
                        date_start: 2021-05-27 10:48:54.086973+00:00
                        date_end: 2021-05-27 10:49:52.075794+00:00
                        n_synced_chunks: 1
                      last_sync_full_agentgroup:
                        date_start: 2021-05-27 10:52:48.038573+00:00
                        date_end: 2021-05-27 10:53:23.057795+00:00
                        n_synced_chunks: 2
                      last_sync_agentinfo:
                        date_start_master: 2021-05-27 10:50:48.832800+00:00
                        date_end_master: 2021-05-27 10:50:48.833854+00:00
                        n_synced_chunks: 1
                      last_keep_alive: 2021-05-27 10:50:18.650204+00:00
                  total_affected_items: 3
                  total_failed_items: 0
                  failed_items: []
                message: All selected nodes healthcheck information was returned
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/ruleset/synchronization:
    get:
      tags:
      - Cluster
      summary: Get cluster nodes ruleset synchronization status
      description: Return ruleset synchronization status for all nodes or a list of
        them. This synchronization only covers the user custom ruleset
      operationId: api.controllers.cluster_controller.get_nodes_ruleset_sync_status
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/nodes_list'
      responses:
        '200':
          description: Ruleset synchronization status for cluster nodes
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseNodeRulesetSynchronizationStatus'
              example:
                data:
                  affected_items:
                  - name: master-node
                    synced: true
                  - name: worker1
                    synced: true
                  - name: worker2
                    synced: true
                  total_affected_items: 3
                  total_failed_items: 0
                  failed_items: []
                message: Nodes ruleset synchronization status was successfully read
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/status:
    get:
      tags:
      - Cluster
      summary: Get cluster status
      description: Return information about the cluster status
      operationId: api.controllers.cluster_controller.get_status
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:status'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      responses:
        '200':
          description: Cluster status
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - $ref: '#/components/schemas/ClusterStatus'
              example:
                data:
                  enabled: 'yes'
                  running: 'yes'
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/api/config:
    get:
      tags:
      - Cluster
      summary: Get nodes API config
      description: Return the API configuration of all nodes (or a list of them) in
        JSON format
      operationId: api.controllers.cluster_controller.get_api_config
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read_api_config'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/nodes_list'
      responses:
        '200':
          description: Current API configuration
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              example:
                data:
                  affected_items:
                  - node_name: master_node
                    node_api_config:
                      host: 0.0.0.0
                      port: 55000
                      drop_privileges: true
                      experimental_features: false
                      max_upload_size: 10485760
                      intervals:
                        request_timeout: 10
                      https:
                        enabled: true
                        key: /var/ossec/api/configuration/ssl/server.key
                        cert: /var/ossec/api/configuration/ssl/server.crt
                        use_ca: false
                        ca: /var/ossec/api/configuration/ssl/ca.crt
                        ssl_protocol: auto
                        ssl_ciphers: ''
                      logs:
                        level: info
                        format: plain
                        max_size:
                          enabled: false
                          size: 1M
                      cors:
                        enabled: false
                        source_route: '*'
                        expose_headers: '*'
                        allow_headers: '*'
                        allow_credentials: false
                      access:
                        max_login_attempts: 50
                        block_time: 300
                        max_request_per_minute: 300
                      upload_configuration:
                        remote_commands:
                          localfile:
                            enabled: true
                            exceptions: []
                          wodle_commands:
                            enabled: true
                            exceptions: []
                        limits:
                          eps:
                            allow: true
                        agents:
                          allow_higher_versions: true
                  - node_name: worker1
                    node_api_config:
                      host: 0.0.0.0
                      port: 55000
                      drop_privileges: true
                      experimental_features: false
                      max_upload_size: 10485760
                      intervals:
                        request_timeout: 10
                      https:
                        enabled: true
                        key: /var/ossec/api/configuration/ssl/server.key
                        cert: /var/ossec/api/configuration/ssl/server.crt
                        use_ca: false
                        ca: /var/ossec/api/configuration/ssl/ca.crt
                        ssl_protocol: auto
                        ssl_ciphers: ''
                      logs:
                        level: info
                        format: plain
                        max_size:
                          enabled: false
                          size: 1M
                      cors:
                        enabled: false
                        source_route: '*'
                        allow_headers: '*'
                        allow_credentials: false
                      access:
                        max_login_attempts: 50
                        block_time: 300
                        max_request_per_minute: 300
                      upload_configuration:
                        remote_commands:
                          localfile:
                            enabled: true
                            exceptions: []
                          wodle_commands:
                            enabled: true
                            exceptions: []
                        limits:
                          eps:
                            allow: true
                        agents:
                          allow_higher_versions: true
                        exceptions: []
                  - node_name: worker2
                    node_api_config:
                      host: 0.0.0.0
                      port: 55000
                      drop_privileges: true
                      experimental_features: false
                      max_upload_size: 10485760
                      intervals:
                        request_timeout: 10
                      https:
                        enabled: true
                        key: /var/ossec/api/configuration/ssl/server.key
                        cert: /var/ossec/api/configuration/ssl/server.crt
                        use_ca: false
                        ca: /var/ossec/api/configuration/ssl/ca.crt
                        ssl_protocol: auto
                        ssl_ciphers: ''
                      logs:
                        level: info
                        format: plain
                        max_size:
                          enabled: false
                          size: 1M
                      cors:
                        enabled: false
                        source_route: '*'
                        allow_headers: '*'
                        allow_credentials: false
                      access:
                        max_login_attempts: 50
                        block_time: 300
                        max_request_per_minute: 300
                      upload_configuration:
                        remote_commands:
                          localfile:
                            enabled: true
                            exceptions: []
                          wodle_commands:
                            enabled: true
                            exceptions: []
                        limits:
                          eps:
                            allow: true
                        agents:
                          allow_higher_versions: true
                  total_affected_items: 3
                  total_failed_items: 0
                  failed_items: []
                message: API configuration was successfully read in all specified
                  nodes
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/status:
    get:
      tags:
      - Cluster
      summary: Get node status
      description: Return the status of all Wazuh daemons in node node_id
      operationId: api.controllers.cluster_controller.get_status_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      responses:
        '200':
          description: Node wazuh daemons statuses
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/WazuhDaemonsStatus'
              example:
                data:
                  affected_items:
                  - wazuh-agentlessd: stopped
                    wazuh-analysisd: running
                    wazuh-authd: stopped
                    wazuh-csyslogd: stopped
                    wazuh-dbd: stopped
                    wazuh-monitord: running
                    wazuh-execd: running
                    wazuh-integratord: stopped
                    wazuh-logcollector: running
                    wazuh-maild: stopped
                    wazuh-remoted: running
                    wazuh-reportd: stopped
                    wazuh-syscheckd: running
                    wazuh-apid: running
                    wazuh-clusterd: running
                    wazuh-db: running
                    wazuh-modulesd: running
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Processes status was successfully read in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/info:
    get:
      tags:
      - Cluster
      summary: Get node info
      description: Return basic information about a specified node such as version,
        compilation date, installation path
      operationId: api.controllers.cluster_controller.get_info_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      responses:
        '200':
          description: Node information
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/WazuhInfo'
              example:
                data:
                  affected_items:
                  - path: /var/ossec
                    version: v4.3.0
                    type: server
                    max_agents: unlimited
                    openssl_support: true
                    tz_offset: 0
                    tz_name: UTC
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Basic information was successfully read in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/configuration:
    get:
      tags:
      - Cluster
      summary: Get node config
      description: Return wazuh configuration used in node {node_id}. The 'section'
        and 'field' parameters will be ignored if 'raw' parameter is provided.
      operationId: api.controllers.cluster_controller.get_configuration_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      - $ref: '#/components/parameters/raw'
      - $ref: '#/components/parameters/section'
      - $ref: '#/components/parameters/field'
      responses:
        '200':
          description: Node configuration
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/WazuhManagerConfiguration'
              example:
                data:
                  affected_items:
                  - global:
                      jsonout_output: true
                      alerts_log: true
                      logall: false
                      logall_json: false
                      email_notification: false
                      smtp_server: smtp.example.wazuh.com
                      email_from: wazuh@example.wazuh.com
                      email_to: recipient@example.wazuh.com
                      email_maxperhour: 12
                      email_log_source: alerts.log
                      agents_disconnection_time: 10m
                      agents_disconnection_alert_time: 0
                      update_check: true
                      white_list:
                      - 127.0.0.1
                      - ^localhost.localdomain$
                      - 80.58.61.250
                      - 80.58.61.254
                    alerts:
                      log_alert_level: '3'
                      email_alert_level: '12'
                    remote:
                      connection: secure
                      port: 1514
                      protocol:
                      - tcp
                      queue_size: 131072
                    rootcheck:
                      disabled: false
                      check_files: true
                      check_trojans: true
                      check_dev: true
                      check_sys: true
                      check_pids: true
                      check_ports: true
                      check_if: true
                      frequency: 43200
                      rootkit_files:
                      - etc/rootcheck/rootkit_files.txt
                      rootkit_trojans:
                      - etc/rootcheck/rootkit_trojans.txt
                      skip_nfs: true
                    cis-cat:
                      disabled: true
                      timeout: 1800
                      interval: 1d
                      scan-on-start: true
                      java_path: wodles/java
                      ciscat_path: wodles/ciscat
                    osquery:
                      disabled: true
                      run_daemon: true
                      log_path: /var/log/osquery/osqueryd.results.log
                      config_path: /etc/osquery/osquery.conf
                      add_labels: true
                    syscollector:
                      disabled: false
                      interval: 1h
                      scan_on_start: true
                      hardware: true
                      os: true
                      network: true
                      packages: true
                      ports:
                        all: false
                        item: true
                      processes: true
                      synchronization:
                        max_eps: 10
                    sca:
                      enabled: true
                      scan_on_start: true
                      interval: 12h
                      skip_nfs: true
                    vulnerability-detection:
                      enabled: true
                      index-status: true
                      feed-update-interval: 60m
                    indexer:
                      enabled: true
                      hosts:
                      - http://127.0.0.1:9200
                      ssl:
                        certificate_authorities:
                          ca:
                          - /etc/filebeat/certs/root-ca.pem
                        certificate:
                        - /etc/filebeat/certs/filebeat.pem
                        key:
                        - /etc/filebeat/certs/filebeat-key.pem
                    syscheck:
                      disabled: false
                      frequency: 43200
                      scan_on_start: true
                      alert_new_files: true
                      auto_ignore:
                        frequency: 10
                        timeframe: 3600
                        item: false
                      directories:
                      - path: /etc
                      - path: /usr/bin
                      - path: /usr/sbin
                      - path: /bin
                      - path: /sbin
                      - path: /boot
                      ignore:
                      - /etc/mtab
                      - /etc/hosts.deny
                      - /etc/mail/statistics
                      - /etc/random-seed
                      - /etc/random.seed
                      - /etc/adjtime
                      - /etc/httpd/logs
                      - /etc/utmpx
                      - /etc/wtmpx
                      - /etc/cups/certs
                      - /etc/dumpdates
                      - /etc/svc/volatile
                      - type: sregex
                        item: .log$|.swp$
                      nodiff:
                      - /etc/ssl/private.key
                      skip_nfs: true
                      skip_dev: true
                      skip_proc: true
                      skip_sys: true
                      process_priority: 10
                      max_eps: 50
                      synchronization:
                        enabled: true
                        interval: 5m
                        max_eps: 10
                    command:
                    - name: disable-account
                      executable: disable-account
                      timeout_allowed: true
                    - name: restart-wazuh
                      executable: restart-wazuh
                    - name: firewall-drop
                      executable: firewall-drop
                      timeout_allowed: true
                    - name: host-deny
                      executable: host-deny
                      timeout_allowed: true
                    - name: route-null
                      executable: route-null
                      timeout_allowed: true
                    - name: win_route-null
                      executable: route-null.exe
                      timeout_allowed: true
                    - name: netsh
                      executable: netsh.exe
                      timeout_allowed: true
                    localfile:
                    - log_format: syslog
                      location: /var/ossec/logs/active-responses.log
                    - log_format: syslog
                      location: /var/log/dpkg.log
                    - log_format: command
                      command: df -P
                      frequency: 360
                    - log_format: full_command
                      command: netstat -tulpn | sed 's/\([[:alnum:]]\+\)\ \+[[:digit:]]\+\
                        \+[[:digit:] ]\+\ \+\(.*\):\([[:digit:]]*\)\ \+\([0-9\.\:\*]\+\).\+\
                        \([[:digit:]]*\/[ [:alnum:]\-]*\).*/\1 \2 == \3 == \4 \5/'
                        | sort -k 4 -g | sed 's/ == \(.*\) ==/:\1/' | sed 1,2d
                      alias: netstat listening ports
                      frequency: 360
                    - log_format: full_command
                      command: last -n 20
                      frequency: 360
                    ruleset:
                      decoder_dir:
                      - ruleset/decoders
                      - etc/decoders
                      rule_dir:
                      - ruleset/rules
                      - etc/rules
                      rule_exclude:
                      - 0215-policy_rules.xml
                      list:
                      - etc/lists/audit-keys
                      - etc/lists/amazon/aws-eventnames
                      - etc/lists/security-eventchannel
                    auth:
                      disabled: false
                      port: '1515'
                      use_source_ip: 'no'
                      purge: 'yes'
                      use_password: 'no'
                      ciphers: HIGH:!ADH:!EXP:!MD5:!RC4:!3DES:!CAMELLIA:@STRENGTH
                      ssl_verify_host: 'no'
                      ssl_manager_cert: etc/sslmanager.cert
                      ssl_manager_key: etc/sslmanager.key
                      ssl_auto_negotiate: 'no'
                    cluster:
                      name: wazuh
                      node_name: master-node
                      node_type: master
                      key: 9d273b53510fef702b54a92e9cffc82e
                      port: '1516'
                      bind_addr: 0.0.0.0
                      nodes:
                      - wazuh-master
                      hidden: 'no'
                      disabled: 'no'
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Configuration was successfully read in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
    put:
      tags:
      - Cluster
      summary: Update node configuration
      description: Replace wazuh configuration for the given node with the data contained
        in the API request
      operationId: api.controllers.cluster_controller.update_configuration
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:update_config'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      requestBody:
        description: Content of the ossec.conf to be uploaded
        required: true
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
      responses:
        '200':
          description: Confirmation message
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - $ref: '#/components/schemas/ConfirmationMessage'
              example:
                message: Configuration was successfully updated
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '406':
          $ref: '#/components/responses/WrongContentTypeResponse'
        '413':
          $ref: '#/components/responses/RequestTooLargeResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/daemons/stats:
    get:
      tags:
      - Cluster
      summary: Get Wazuh daemon stats from a cluster node
      description: Return Wazuh statistical information from specified daemons in
        a specified cluster node
      operationId: api.controllers.cluster_controller.get_daemon_stats_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      - $ref: '#/components/parameters/daemons_list'
      responses:
        '200':
          description: Wazuh daemon stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhDaemonStats'
              example:
                data:
                  affected_items:
                  - uptime: 2022-07-21 10:09:20+00:00
                    timestamp: 2022-07-21 10:48:32+00:00
                    name: wazuh-remoted
                    metrics:
                      bytes:
                        received: 0
                        sent: 0
                      keys_reload_count: 0
                      messages:
                        received_breakdown:
                          control: 0
                          control_breakdown:
                            keepalive: 0
                            request: 0
                            shutdown: 0
                            startup: 0
                          dequeued_after: 0
                          discarded: 0
                          event: 0
                          ping: 0
                          unknown: 0
                        sent_breakdown:
                          ack: 0
                          ar: 0
                          discarded: 0
                          request: 0
                          sca: 0
                          shared: 0
                      queues:
                        received:
                          size: 131072
                          usage: 0
                      tcp_sessions: 0
                  total_affected_items: 1
                  failed_items: []
                  total_failed_items: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/stats:
    get:
      tags:
      - Cluster
      summary: Get node stats
      description: Return Wazuh statistical information in node {node_id} for the
        current or specified date
      operationId: api.controllers.cluster_controller.get_stats_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      - $ref: '#/components/parameters/date'
      responses:
        '200':
          description: Wazuh node stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - hour: 10
                    alerts:
                    - sigid: 530
                      level: 0
                      times: 121
                    - sigid: 501
                      level: 3
                      times: 5
                    - sigid: 502
                      level: 3
                      times: 1
                    - sigid: 503
                      level: 3
                      times: 1
                    - sigid: 506
                      level: 3
                      times: 2
                    - sigid: 515
                      level: 0
                      times: 12
                    - sigid: 19000
                      level: 0
                      times: 980
                    - sigid: 19007
                      level: 7
                      times: 470
                    - sigid: 19008
                      level: 3
                      times: 305
                    - sigid: 19009
                      level: 3
                      times: 185
                    - sigid: 19004,
                      level: 7,
                      times: 10
                    totalAlerts: 2092
                    events: 2104
                    syscheck: 12
                    firewall: 0
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Statistical information for each node was successfully read
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/stats/hourly:
    get:
      tags:
      - Cluster
      summary: Get node stats hour
      description: Return Wazuh statistical information in node {node_id} per hour.
        Each number in the averages field represents the average of alerts per hour
      operationId: api.controllers.cluster_controller.get_stats_hourly_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      responses:
        '200':
          description: Wazuh node hourly stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - averages:
                    - 40
                    - 24
                    - 67
                    - 234
                    - 66
                    - 24
                    - 634
                    - 66
                    - 123
                    - 56
                    - 65
                    - 23
                    - 666
                    - 233
                    - 646
                    - 44
                    - 64
                    - 99
                    - 34
                    - 235
                    - 653
                    - 25
                    - 65
                    - 23
                    interactions: 0
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Statistical information per hour for each node was successfully
                  read
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/stats/weekly:
    get:
      tags:
      - Cluster
      summary: Get node stats week
      description: Return Wazuh statistical information in node {node_id} per week.
        Each number in the averages field represents the average of alerts per hour
        for that specific day
      operationId: api.controllers.cluster_controller.get_stats_weekly_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      responses:
        '200':
          description: Wazuh node weekly stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - Sun:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Mon:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Tue:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Wed:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Thu:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Fri:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  - Sat:
                      averages:
                      - 40
                      - 24
                      - 67
                      - 234
                      - 66
                      - 24
                      - 634
                      - 66
                      - 123
                      - 56
                      - 65
                      - 23
                      - 666
                      - 233
                      - 646
                      - 44
                      - 64
                      - 99
                      - 34
                      - 235
                      - 653
                      - 25
                      - 65
                      - 23
                      interactions: 0
                  total_affected_items: 7
                  total_failed_items: 0
                  failed_items: []
                message: Statistical information per week for each node was successfully
                  read
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/stats/analysisd:
    get:
      tags:
      - Cluster
      deprecated: true
      summary: Get node stats analysisd
      description: Return Wazuh analysisd statistical information in node {node_id}
      operationId: api.controllers.cluster_controller.get_stats_analysisd_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      responses:
        '200':
          description: Wazuh node analysisd stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - total_events_decoded: 113.0
                    syscheck_events_decoded: 2.0
                    syscollector_events_decoded: 0.0
                    rootcheck_events_decoded: 4.0
                    sca_events_decoded: 2.0
                    winevt_events_decoded: 0.0
                    dbsync_messages_dispatched: 55.0
                    other_events_decoded: 50.0
                    events_processed: 57.0
                    events_received: 114.0
                    events_dropped: 0.0
                    alerts_written: 3.0
                    firewall_written: 0.0
                    fts_written: 0.0
                    syscheck_queue_usage: 0.0
                    syscheck_queue_size: 16384.0
                    syscollector_queue_usage: 0.0
                    syscollector_queue_size: 16384.0
                    rootcheck_queue_usage: 0.0
                    rootcheck_queue_size: 16384.0
                    sca_queue_usage: 0.0
                    sca_queue_size: 16384.0
                    hostinfo_queue_usage: 0.0
                    hostinfo_queue_size: 16384.0
                    winevt_queue_usage: 0.0
                    winevt_queue_size: 16384.0
                    dbsync_queue_usage: 0.0
                    dbsync_queue_size: 16384.0
                    upgrade_queue_usage: 0.0
                    upgrade_queue_size: 16384.0
                    event_queue_usage: 0.0
                    event_queue_size: 16384.0
                    rule_matching_queue_usage: 0.0
                    rule_matching_queue_size: 16384.0
                    alerts_queue_usage: 0.0
                    alerts_queue_size: 16384.0
                    firewall_queue_usage: 0.0
                    firewall_queue_size: 16384.0
                    statistical_queue_usage: 0.0
                    statistical_queue_size: 16384.0
                    archives_queue_usage: 0.0
                    archives_queue_size: 16384.0
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Statistical information for each node was successfully read
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/stats/remoted:
    get:
      tags:
      - Cluster
      deprecated: true
      summary: Get node stats remoted
      description: Return Wazuh remoted statistical information in node {node_id}
      operationId: api.controllers.cluster_controller.get_stats_remoted_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      responses:
        '200':
          description: Wazuh node remoted stats
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhStats'
              example:
                data:
                  affected_items:
                  - queue_size: 0.0
                    total_queue_size: 131072.0
                    tcp_sessions: 4.0
                    evt_count: 9089.0
                    ctrl_msg_count: 2099.0
                    discarded_count: 0.0
                    sent_bytes: 784598.0
                    recv_bytes: 4541779.0
                    dequeued_after_close: 0.0
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Statistical information for each node was successfully read
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/logs:
    get:
      tags:
      - Cluster
      summary: Get node logs
      description: Return the last 2000 wazuh log entries in the specified node
      operationId: api.controllers.cluster_controller.get_log_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/log_lines'
      - $ref: '#/components/parameters/sort'
      - $ref: '#/components/parameters/search'
      - $ref: '#/components/parameters/tag'
      - $ref: '#/components/parameters/log_level'
      - $ref: '#/components/parameters/query'
      - $ref: '#/components/parameters/select'
      - $ref: '#/components/parameters/distinct'
      responses:
        '200':
          description: Wazuh node logs
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseWazuhLogs'
              example:
                data:
                  affected_items:
                  - timestamp: '2021-05-27T12:18:08Z'
                    tag: wazuh-remoted
                    level: debug
                    description: ' TCP socket 20 already in keystore. Updating...'
                  - timestamp: '2021-05-27T12:18:08Z'
                    tag: wazuh-remoted
                    level: debug
                    description: ' Agent ''003'' group is ''default'''
                  - timestamp: '2021-05-27T12:18:08Z'
                    tag: wazuh-remoted
                    level: debug
                    description: ' Agent ''003'' with group ''default'' file ''merged.mg''
                      MD5 ''9a016508cea1e997ab8569f5cfab30f5'''
                  total_affected_items: 3
                  total_failed_items: 0
                  failed_items: []
                message: Logs were successfully read in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/logs/summary:
    get:
      tags:
      - Cluster
      summary: Get node logs summary
      description: Return a summary of the last 2000 wazuh log entries in the specified
        node
      operationId: api.controllers.cluster_controller.get_log_summary_node
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      responses:
        '200':
          description: Wazuh node logs summary
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/WazuhLogsSummary'
              example:
                data:
                  affected_items:
                  - indexer-connector:
                      all: 24
                      info: 0
                      error: 0
                      critical: 0
                      warning: 24
                      debug: 0
                  - wazuh-db:
                      info: 1
                      all: 4
                      critical: 0
                      debug: 0
                      error: 3
                      warning: 0
                  - wazuh-modulesd:content_manager:
                      info: 1
                      all: 1
                      critical: 0
                      debug: 0
                      error: 0
                      warning: 0
                  - wazuh-modulesd:router:
                      info: 1
                      all: 1
                      critical: 0
                      debug: 0
                      error: 0
                      warning: 0
                  - wazuh-remoted:
                      info: 744
                      all: 0
                      critical: 0
                      debug: 744
                      error: 0
                      warning: 0
                  total_affected_items: 5
                  failed_items: []
                  total_failed_items: 0
                message: Log was successfully summarized in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/restart:
    put:
      tags:
      - Cluster
      summary: Restart nodes
      description: Restart all nodes in the cluster or a list of them
      operationId: api.controllers.cluster_controller.put_restart
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      - $ref: '#/x-rbac-catalog/actions/cluster:restart'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/nodes_list'
      responses:
        '200':
          description: List of affected nodes
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseNodeIDs'
                example:
                  data:
                    affected_items:
                    - master-node
                    - worker1
                    - worker2
                    total_affected_items: 3
                    total_failed_items: 0
                    failed_items: []
                  message: Restart request sent to all specified nodes
                  error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/configuration/validation:
    get:
      tags:
      - Cluster
      summary: Check nodes config
      description: Return whether the Wazuh configuration is correct or not in all
        cluster nodes or a list of them
      operationId: api.controllers.cluster_controller.get_conf_validation
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/nodes_list'
      responses:
        '200':
          description: Configuration status
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/AllItemsResponseValidationStatus'
                example:
                  data:
                    affected_items:
                    - name: master-node
                      status: OK
                    - name: worker1
                      status: OK
                    - name: worker2
                      status: OK
                    total_affected_items: 3
                    total_failed_items: 0
                    failed_items: []
                  message: Validation was successfully checked in all nodes
                  error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
  /cluster/{node_id}/configuration/{component}/{configuration}:
    get:
      tags:
      - Cluster
      summary: Get node active configuration
      description: Return the requested configuration in JSON format for the specified
        node
      operationId: api.controllers.cluster_controller.get_node_config
      x-rbac-actions:
      - $ref: '#/x-rbac-catalog/actions/cluster:read'
      parameters:
      - $ref: '#/components/parameters/pretty'
      - $ref: '#/components/parameters/wait_for_complete'
      - $ref: '#/components/parameters/node_id'
      - $ref: '#/components/parameters/component'
      - $ref: '#/components/parameters/configuration'
      responses:
        '200':
          description: Cluster configuration on-demand
          content:
            application/json:
              schema:
                properties:
                  data:
                    oneOf:
                    - type: array
                    - type: object
                      description: The output format depends on the configuration
                        and component requested
              example:
                data:
                  affected_items:
                  - wdb:
                      backup:
                        database: global
                        enabled: true
                        interval: 86400
                        max_files: 3
                  total_affected_items: 1
                  total_failed_items: 0
                  failed_items: []
                message: Active configuration was successfully read in specified node
                error: 0
        '400':
          $ref: '#/components/responses/ResponseError'
        '401':
          $ref: '#/components/responses/UnauthorizedResponse'
        '403':
          $ref: '#/components/responses/PermissionDeniedResponse'
        '405':
          $ref: '#/components/responses/InvalidHTTPMethodResponse'
        '429':
          $ref: '#/components/responses/TooManyRequestsResponse'
components:
  schemas:
    ApiResponse:
      type: object
      properties:
        message:
          type: string
          description: Human readable description to explain the result of the request
    AllItemsResponseWazuhDaemonStats:
      allOf:
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              oneOf:
              - $ref: '#/components/schemas/WazuhRemotedStatsItem'
              - $ref: '#/components/schemas/WazuhAnalysisdStatsItem'
              - $ref: '#/components/schemas/WazuhDBStatsItem'
      - $ref: '#/components/schemas/AllItemsResponse'
    AllItemsResponseNodeIDs:
      allOf:
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/NodeID'
      - $ref: '#/components/schemas/AllItemsResponse'
    AllItemsResponseNodeHealthcheck:
      allOf:
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/NodeHealthcheck'
      - $ref: '#/components/schemas/AllItemsResponse'
    AllItemsResponseNodeRulesetSynchronizationStatus:
      allOf:
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/NodeRulesetSyncStatus'
      - $ref: '#/components/schemas/AllItemsResponse'
    AllItemsResponseClusterNodes:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/ClusterNode'
    AllItemsResponseWazuhLogs:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/WazuhLogs'
    AllItemsResponseValidationStatus:
      allOf:
      - $ref: '#/components/schemas/AllItemsResponse'
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              $ref: '#/components/schemas/ValidationStatus'
    AllItemsResponseWazuhStats:
      allOf:
      - type: object
        required:
        - affected_items
        properties:
          affected_items:
            type: array
            description: Items that successfully applied the API call action
            items:
              anyOf:
              - $ref: '#/components/schemas/WazuhStats'
              - $ref: '#/components/schemas/WazuhHourlyStats'
              - $ref: '#/components/schemas/WazuhWeeklyStats'
              - $ref: '#/components/schemas/WazuhAnalysisdStats'
              - $ref: '#/components/schemas/WazuhRemotedStats'
      - $ref: '#/components/schemas/AllItemsResponse'
    ClusterLocalInfo:
      type: object
      properties:
        data:
          properties:
            node:
              description: Node name
              type: string
            cluster:
              description: Cluster name the node belongs to
              type: string
            type:
              description: Node type
              type: string
    ClusterLocalConfig:
      type: object
      properties:
        data:
          properties:
            name:
              description: Cluster name
              type: string
            node_name:
              description: Node name
              type: string
            node_type:
              description: Node type
              type: string
              enum:
              - master
              - worker
            key:
              description: Cluster key used to encrypt messages
              type: string
            port:
              description: Port used by the **master** node to communicate with workers
              type: integer
            bind_addr:
              description: Network interface used by the **master** to listen to incoming
                connections
              type: string
            nodes:
              description: List of cluster master nodes. This list is used by **worker**
                nodes to connect to the master
              type: array
              items:
                type: string
            hidden:
              description: Whether to hide the cluster information in the alerts
              type: string
            disabled:
              description: Whether the cluster is enabled or not
              type: boolean
    ClusterStatus:
      type: object
      properties:
        data:
          properties:
            enabled:
              description: Whether the cluster is enabled in the Wazuh configuration
              type: string
              enum:
              - 'yes'
              - 'no'
            running:
              description: Whether the cluster daemon is running
              type: string
              enum:
              - 'yes'
              - 'no'
    WazuhDaemonsStatus:
      type: object
      properties:
        wazuh-agentlessd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-analysisd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-authd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-csyslogd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-dbd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-execd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-integratord:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-logcollector:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-maild:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-monitord:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-remoted:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-reportd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-syscheckd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-apid:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-clusterd:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-db:
          $ref: '#/components/schemas/DaemonStatus'
        wazuh-modulesd:
          $ref: '#/components/schemas/DaemonStatus'
    WazuhInfo:
      type: object
      properties:
        path:
          type: string
          format: paths
          description: Wazuh installation path
        version:
          type: string
          description: Wazuh version
        type:
          type: string
          description: Wazuh installation type
          enum:
          - server
          - local
          - hybrid
        max_agents:
          type: string
          minimum: 0
          description: Maximum number of agents that can be registered.
        openssl_support:
          type: string
        tz_offset:
          type: string
        tz_name:
          type: string
    WazuhManagerConfiguration:
      type: object
      properties:
        active-response:
          type: array
          items:
            type: object
        agentless:
          type: array
          items:
            type: object
        alerts:
          type: object
        auth:
          type: object
        cluster:
          type: object
        command:
          type: array
          items:
            type: object
        database_output:
          type: object
        email_alerts:
          type: object
        gcp-pubsub:
          type: object
        global:
          type: object
        integration:
          type: array
          items:
            type: object
        labels:
          type: object
        localfile:
          type: array
          items:
            type: object
        logging:
          type: object
        remote:
          type: array
          items:
            type: object
        reports:
          type: object
        rootcheck:
          type: object
        ruleset:
          type: object
        sca:
          type: object
        socket:
          type: object
        syscheck:
          type: object
        syslog_output:
          type: array
          items:
            type: object
        aws-s3:
          type: object
        azure-logs:
          type: object
        cis-cat:
          type: object
        docker-listener:
          type: object
        open-scap:
          type: object
        osquery:
          type: object
        syscollector:
          type: object
    WazuhLogsSummary:
      type: object
      properties:
        indexer-connector:
          $ref: '#/components/schemas/LogSummary'
        wazuh-agentlessd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-analysisd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-authd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-csyslogd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-dbd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-execd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-integratord:
          $ref: '#/components/schemas/LogSummary'
        wazuh-maild:
          $ref: '#/components/schemas/LogSummary'
        wazuh-monitord:
          $ref: '#/components/schemas/LogSummary'
        wazuh-logcollector:
          $ref: '#/components/schemas/LogSummary'
        wazuh-remoted:
          $ref: '#/components/schemas/LogSummary'
        wazuh-reportd:
          $ref: '#/components/schemas/LogSummary'
        rootcheck:
          $ref: '#/components/schemas/LogSummary'
        wazuh-syscheckd:
          $ref: '#/components/schemas/LogSummary'
        sca:
          $ref: '#/components/schemas/LogSummary'
        wazuh-db:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:agent-upgrade:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:aws-s3:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:azure-logs:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:ciscat:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:control:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:command:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:content_manager:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:database:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:docker-listener:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:download:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:oscap:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:osquery:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:syscollector:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:vulnerability-scanner:
          $ref: '#/components/schemas/LogSummary'
        wazuh-modulesd:task-manager:
          $ref: '#/components/schemas/LogSummary'
    ConfirmationMessage:
      type: object
      properties:
        message:
          type: string
          description: Confirmation message
  responses:
    ResponseError:
      description: Response to report a bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Bad Request
            detail: '''{invalid_param}'' is not a ''{expected_type}''. Failed validating
              ''format'' in schema[''items'']: {''description'': ''{parameter_name}'',
              ''format'': ''{expected_format}'', ''minLength'': {expected_length},
              ''type'': ''{expected_type}'', ''x-scope'': ['''', ''#/components/parameters/{parameter_name}'']}'
    PermissionDeniedResponse:
      description: Response to report a permission denied request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            title: Permission Denied
            detail: 'Permission denied: Resource type: *:*'
            remediation: Please, make sure you have permissions to execute the current
              request. For more information on how to set up permissions, please visit
              https://documentation.wazuh.com/4.9/user-manual/api/rbac/configuration.html
            error: 4000
            dapi_errors:
              unknown-node:
                error: 'Permission denied: Resource type: *:*'
    UnauthorizedResponse:
      description: Response to report an unauthorized request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Unauthorized
            detail: No authorization token provided
    InvalidHTTPMethodResponse:
      description: Response to report an invalid HTTP method
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Method Not Allowed
            detail: Specified method is invalid for this resource
    WrongContentTypeResponse:
      description: Response to report an invalid content-type
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Wazuh Error
            detail: The body type is not the one specified in the content-type
            error: 6002
    RequestTooLargeResponse:
      description: Maximum request body size exceeded
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Request Entity Too Large
            detail: Maximum request body size 1048576 exceeded, actual body size 1225245
    TooManyRequestsResponse:
      description: Maximum number of request per minute reached
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RequestError'
          example:
            title: Wazuh Error
            detail: Maximum number of requests per minute reached
            remediation: 'This limit can be changed in api.yaml file. More information
              here: https://documentation.wazuh.com/4.9/user-manual/api/security/configuration.html'
            code: 6001
  parameters:
    component:
      in: path
      name: component
      description: Selected agent's component
      required: true
      schema:
        type: string
        enum:
        - agent
        - agentless
        - analysis
        - auth
        - com
        - csyslog
        - integrator
        - logcollector
        - mail
        - monitor
        - request
        - syscheck
        - wazuh-db
        - wmodules
    configuration:
      in: path
      name: configuration
      description: '<p>Selected agent''s configuration to read. The configuration
        to read depends on the selected component.

        The following table shows all available combinations of component and configuration
        values:</p>

        <table class="table table-striped table-bordered">

        <thead>

        <tr>

        <th>Component</th>

        <th>Configuration</th>

        <th>Tag</th>

        </tr>

        </thead>

        <tbody>

        <tr>

        <td>agent</td>

        <td>client</td>

        <td><code>&lt;client&gt;</code></td>

        </tr>

        <tr>

        <td>agent</td>

        <td>buffer</td>

        <td><code>&lt;client_buffer&gt;</code></td>

        </tr>

        <tr>

        <td>agent</td>

        <td>labels</td>

        <td><code>&lt;labels&gt;</code></td>

        </tr>

        <tr>

        <td>agent</td>

        <td>internal</td>

        <td><code>&lt;agent&gt;</code>, <code>&lt;monitord&gt;</code>, <code>&lt;remoted&gt;</code></td>

        </tr>

        <tr>

        <td>agentless</td>

        <td>agentless</td>

        <td><code>&lt;agentless&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>global</td>

        <td><code>&lt;global&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>active_response</td>

        <td><code>&lt;active-response&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>alerts</td>

        <td><code>&lt;alerts&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>command</td>

        <td><code>&lt;command&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>rules</td>

        <td><code>&lt;rule&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>decoders</td>

        <td><code>&lt;decoder&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>internal</td>

        <td><code>&lt;analysisd&gt;</code></td>

        </tr>

        <tr>

        <td>analysis</td>

        <td>rule_test</td>

        <td><code>&lt;rule_test&gt;</code></td>

        </tr>

        <tr>

        <td>auth</td>

        <td>auth</td>

        <td><code>&lt;auth&gt;</code></td>

        </tr>

        <tr>

        <td>com</td>

        <td>active-response</td>

        <td><code>&lt;active-response&gt;</code></td>

        </tr>

        <tr>

        <td>com</td>

        <td>logging</td>

        <td><code>&lt;logging&gt;</code></td>

        </tr>

        <tr>

        <td>com</td>

        <td>internal</td>

        <td><code>&lt;execd&gt;</code></td>

        </tr>

        <tr>

        <td>com</td>

        <td>cluster</td>

        <td><code>&lt;cluster&gt;</code></td>

        </tr>

        <tr>

        <td>csyslog</td>

        <td>csyslog</td>

        <td><code>&lt;csyslog_output&gt;</code></td>

        </tr>

        <tr>

        <td>integrator</td>

        <td>integration</td>

        <td><code>&lt;integration&gt;</code></td>

        </tr>

        <tr>

        <td>logcollector</td>

        <td>localfile</td>

        <td><code>&lt;localfile&gt;</code></td>

        </tr>

        <tr>

        <td>logcollector</td>

        <td>socket</td>

        <td><code>&lt;socket&gt;</code></td>

        </tr>

        <tr>

        <td>logcollector</td>

        <td>internal</td>

        <td><code>&lt;logcollector&gt;</code></td>

        </tr>

        <tr>

        <td>mail</td>

        <td>global</td>

        <td><code>&lt;global&gt;&lt;email...&gt;</code></td>

        </tr>

        <tr>

        <td>mail</td>

        <td>alerts</td>

        <td><code>&lt;email_alerts&gt;</code></td>

        </tr>

        <tr>

        <td>mail</td>

        <td>internal</td>

        <td><code>&lt;maild&gt;</code></td>

        </tr>

        <tr>

        <td>monitor</td>

        <td>global</td>

        <td><code>&lt;global&gt;</code></td>

        </tr>

        <tr>

        <td>monitor</td>

        <td>internal</td>

        <td><code>&lt;monitord&gt;</code></td>

        </tr>

        <tr>

        <td>monitor</td>

        <td>reports</td>

        <td><code>&lt;reports&gt;</code></td>

        </tr>

        <tr>

        <td>request</td>

        <td>global</td>

        <td><code>&lt;global&gt;</code></td>

        </tr>

        <tr>

        <td>request</td>

        <td>remote</td>

        <td><code>&lt;remote&gt;</code></td>

        </tr>

        <tr>

        <td>request</td>

        <td>internal</td>

        <td><code>&lt;remoted&gt;</code></td>

        </tr>

        <tr>

        <td>syscheck</td>

        <td>syscheck</td>

        <td><code>&lt;syscheck&gt;</code></td>

        </tr>

        <tr>

        <td>syscheck</td>

        <td>rootcheck</td>

        <td><code>&lt;rootcheck&gt;</code></td>

        </tr>

        <tr>

        <td>syscheck</td>

        <td>internal</td>

        <td><code>&lt;syscheck&gt;</code>, <code>&lt;rootcheck&gt;</code></td>

        </tr>

        <tr>

        <td>wazuh-db</td>

        <td>internal</td>

        <td><code>&lt;wazuh_db&gt;</code></td>

        </tr>

        <tr>

        <td>wazuh-db</td>

        <td>wdb</td>

        <td><code>&lt;wdb&gt;</code></td>

        </tr>

        <tr>

        <td>wmodules</td>

        <td>wmodules</td>

        <td><code>&lt;wodle&gt;</code></td>

        </tr>

        </tbody>

        </table>

        '
      required: true
      schema:
        type: string
        enum:
        - client
        - buffer
        - labels
        - internal
        - agentless
        - global
        - active_response
        - alerts
        - command
        - rules
        - decoders
        - auth
        - logging
        - reports
        - active-response
        - cluster
        - csyslog
        - integration
        - localfile
        - socket
        - remote
        - syscheck
        - rootcheck
        - wdb
        - wmodules
        - rule_test
    daemons_list:
      in: query
      name: daemons_list
      description: List of daemon names (separated by comma), all daemons selected
        by default if not specified
      schema:
        type: array
        items:
          type: string
          enum:
          - wazuh-analysisd
          - wazuh-remoted
          - wazuh-db
    limit:
      in: query
      name: limit
      description: 'Maximum number of elements to return. Although up to 100.000 can
        be specified, it is recommended not to exceed 500 elements. Responses may
        be slower the more this number is exceeded. '
      schema:
        type: integer
        format: int32
        default: 500
        minimum: 1
        maximum: 100000
    log_lines:
      in: query
      name: limit
      description: Maximum number of lines to return.
      schema:
        type: integer
        format: int32
        default: 500
        minimum: 1
        maximum: 500
    nodes_list:
      in: query
      name: nodes_list
      description: List of node IDs (separated by comma), all nodes selected by default
        if not specified
      schema:
        type: array
        items:
          type: string
    offset:
      in: query
      name: offset
      description: First element to return in the collection
      schema:
        type: integer
        format: int32
        default: 0
        minimum: 0
    pretty:
      in: query
      name: pretty
      description: Show results in human-readable format
      schema:
        type: boolean
        default: false
    query:
      in: query
      name: q
      description: Query to filter results by. For example q=&quot;status=active&quot;
      schema:
        type: string
    raw:
      in: query
      name: raw
      description: Format response in plain text
      required: false
      schema:
        type: boolean
    search:
      in: query
      name: search
      description: Look for elements containing the specified string. To obtain a
        complementary search, use '-' at the beginning
      schema:
        type: string
        format: search
    select:
      in: query
      name: select
      description: 'Select which fields to return (separated by comma). Use ''.''
        for nested fields. For example, ''{field1: field2}'' may be selected with
        ''field1.field2'''
      schema:
        type: array
        items:
          type: string
          format: names
    sort:
      in: query
      name: sort
      description: 'Sort the collection by a field or fields (separated by comma).
        Use +/- at the beggining to list in ascending or descending order. Use ''.''
        for nested fields. For example, ''{field1: field2}'' may be selected with
        ''field1.field2'''
      schema:
        type: string
        format: sort
    wait_for_complete:
      in: query
      name: wait_for_complete
      description: Disable timeout response
      schema:
        type: boolean
        default: false
    node_type:
      in: query
      name: type
      description: Filter by node type
      schema:
        type: string
        enum:
        - worker
        - master
    node_id:
      in: path
      name: node_id
      description: Cluster node name
      required: true
      schema:
        type: string
        format: names
    section:
      in: query
      name: section
      description: Indicates the wazuh configuration section
      schema:
        type: string
        enum:
        - active-response
        - agentless
        - alerts
        - auth
        - client
        - client_buffer
        - cluster
        - command
        - database_output
        - email_alerts
        - global
        - integration
        - labels
        - localfile
        - logging
        - remote
        - reports
        - rootcheck
        - ruleset
        - sca
        - socket
        - syscheck
        - syslog_output
        - vulnerability-detection
        - indexer
        - aws-s3
        - azure-logs
        - cis-cat
        - docker-listener
        - open-scap
        - osquery
        - syscollector
    field:
      in: query
      name: field
      description: 'Indicate a section child. E.g, fields for *ruleset* section are:
        decoder_dir, rule_dir, etc'
      schema:
        type: string
        format: names
    date:
      in: query
      name: date
      description: Date to obtain statistical information from. Format YYYY-MM-DD
      schema:
        type: string
        format: date
    tag:
      in: query
      name: tag
      description: Wazuh component that logged the event
      schema:
        type: string
        format: alphanumeric
    log_level:
      in: query
      name: level
      description: Filter by log level
      schema:
        type: string
        enum:
        - critical
        - debug
        - debug2
        - error
        - info
        - warning
    distinct:
      in: query
      name: distinct
      description: Look for distinct values.
      schema:
        type: boolean
        default: false
